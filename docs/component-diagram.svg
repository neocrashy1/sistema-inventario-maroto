<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700" role="img" aria-label="Diagrama de Componentes: Agente Python → API REST → Banco → Dashboard React">
  <style>
    .box { fill:#ffffff; stroke:#1f2937; stroke-width:2; rx:10; ry:10; }
    .title { font: 700 18px sans-serif; fill:#111827; }
    .text { font: 400 14px sans-serif; fill:#374151; }
    .arrow { stroke:#111827; stroke-width:2; marker-end:url(#arrowhead); }
    .note { font: 400 12px sans-serif; fill:#6b7280; }
    .badge { font: 700 12px sans-serif; fill:#0ea5e9; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#111827" />
    </marker>
  </defs>

  <!-- Header -->
  <text x="30" y="40" class="title">Arquitetura Cliente-Servidor</text>
  <text x="30" y="65" class="text">Agente Python → API REST (FastAPI) → Banco (PostgreSQL/SQL Server) → Dashboard React</text>

  <!-- Agent Cluster -->
  <rect x="40" y="120" width="300" height="210" class="box" />
  <text x="60" y="150" class="title">Agente Python</text>
  <text x="60" y="175" class="text">• Coleta métricas (CPU, Mem, Disco, Rede)</text>
  <text x="60" y="195" class="text">• Envia status e alertas via HTTPS</text>
  <text x="60" y="215" class="text">• Autenticação: mTLS + Token do agente</text>
  <text x="60" y="235" class="text">• Descoberta/Registro de máquina</text>
  <text x="60" y="255" class="note">Execução: Python 3.11, aiohttp/requests</text>

  <!-- API Layer -->
  <rect x="420" y="100" width="330" height="250" class="box" />
  <text x="440" y="130" class="title">API REST (FastAPI)</text>
  <text x="440" y="155" class="text">• Endpoints: /machines/register, /machines/status</text>
  <text x="440" y="175" class="text">• Suporte: /tickets/create, /alerts/send</text>
  <text x="440" y="195" class="text">• Autenticação: JWT para Dashboard</text>
  <text x="440" y="215" class="text">• mTLS para agentes</text>
  <text x="440" y="235" class="text">• Validação, rate limit, auditoria</text>
  <text x="440" y="255" class="note">Stack: Uvicorn, SQLAlchemy, Alembic</text>

  <!-- DB Layer -->
  <rect x="800" y="120" width="340" height="210" class="box" />
  <text x="820" y="150" class="title">Banco de Dados</text>
  <text x="820" y="175" class="text">• PostgreSQL (primário) | SQL Server (opcional)</text>
  <text x="820" y="195" class="text">• Tabelas: machines, statuses, alerts, tickets</text>
  <text x="820" y="215" class="text">• Índices por máquina e tempo</text>
  <text x="820" y="235" class="note">Conexão via SQLAlchemy + drivers nativos</text>

  <!-- Dashboard -->
  <rect x="420" y="380" width="330" height="220" class="box" />
  <text x="440" y="410" class="title">Dashboard React</text>
  <text x="440" y="435" class="text">• Autenticação JWT</text>
  <text x="440" y="455" class="text">• Consulta métricas e abertura de tickets</text>
  <text x="440" y="475" class="text">• Atualizações em tempo real (WebSocket)</text>
  <text x="440" y="495" class="note">Stack: React + TS + Vite + React Query</text>

  <!-- Security/Gateway -->
  <rect x="40" y="380" width="300" height="220" class="box" />
  <text x="60" y="410" class="title">Gateway / TLS</text>
  <text x="60" y="435" class="text">• TLS 1.2+ obrigatório</text>
  <text x="60" y="455" class="text">• mTLS entre Agente → API</text>
  <text x="60" y="475" class="text">• CORS e rate limiting</text>
  <text x="60" y="495" class="note">Traefik/Nginx com certificados gerenciados</text>

  <!-- Arrows -->
  <line x1="340" y1="210" x2="420" y2="210" class="arrow" />
  <text x="345" y="195" class="badge">HTTPS + mTLS</text>

  <line x1="750" y1="210" x2="800" y2="210" class="arrow" />
  <text x="755" y="195" class="badge">ORM</text>

  <line x1="585" y1="350" x2="585" y2="380" class="arrow" />
  <text x="595" y="365" class="badge">JWT</text>

  <line x1="585" y1="600" x2="585" y2="350" class="arrow" />
  <text x="595" y="585" class="badge">WebSocket</text>

  <!-- Legend -->
  <rect x="800" y="380" width="340" height="220" class="box" />
  <text x="820" y="410" class="title">Fluxos Principais</text>
  <text x="820" y="435" class="text">1) Registro: Agente → API (/machines/register)</text>
  <text x="820" y="455" class="text">2) Status: Agente → API (/machines/status)</text>
  <text x="820" y="475" class="text">3) Alertas: Agente → API (/alerts/send)</text>
  <text x="820" y="495" class="text">4) Tickets: Dashboard → API (/tickets/create)</text>
  <text x="820" y="515" class="note">Todos via HTTPS; agentes com mTLS, dashboard com JWT</text>
</svg>