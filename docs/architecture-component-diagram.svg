<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="960" height="600" viewBox="0 0 960 600">
  <defs>
    <style>
      .box{fill:#ffffff;stroke:#1f2937;stroke-width:2;rx:12;ry:12;}
      .title{font: 700 16px sans-serif; fill:#111827;}
      .text{font: 400 13px sans-serif; fill:#374151;}
      .arrow{stroke:#1f2937;stroke-width:2; marker-end:url(#arrowhead);}    
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1f2937" />
    </marker>
  </defs>

  <!-- Header -->
  <text x="20" y="36" class="title">Arquitetura: Agente Python → API REST → Banco → Dashboard React</text>
  <text x="20" y="58" class="text">TLS obrigatório, autenticação por token/JWT, RBAC, logs e auditoria</text>

  <!-- Agent Box -->
  <rect x="60" y="120" width="240" height="140" class="box" />
  <text x="80" y="150" class="title">Agente Python</text>
  <text x="80" y="172" class="text">• Coleta: OS, HW, rede</text>
  <text x="80" y="190" class="text">• Classifica deviceType</text>
  <text x="80" y="208" class="text">• Envia registros/heartbeat</text>
  <text x="80" y="226" class="text">• Autenticação: Bearer Token</text>

  <!-- API Box -->
  <rect x="360" y="100" width="260" height="180" class="box" />
  <text x="380" y="130" class="title">API REST (FastAPI)</text>
  <text x="380" y="152" class="text">/machines/register (POST)</text>
  <text x="380" y="170" class="text">/machines/status (GET)</text>
  <text x="380" y="188" class="text">/tickets/create (POST)</text>
  <text x="380" y="206" class="text">/alerts/send (POST)</text>
  <text x="380" y="224" class="text">• JWT/OAuth2, Rate limiting</text>
  <text x="380" y="242" class="text">• Validação/Logs/Auditoria</text>

  <!-- DB Box -->
  <rect x="360" y="320" width="260" height="180" class="box" />
  <text x="380" y="350" class="title">Banco de Dados</text>
  <text x="380" y="372" class="text">PostgreSQL (preferido) / SQL Server</text>
  <text x="380" y="390" class="text">Tabelas: machines, statuses, tickets</text>
  <text x="380" y="408" class="text">alerts, users, roles, api_tokens</text>

  <!-- Dashboard Box -->
  <rect x="660" y="120" width="240" height="140" class="box" />
  <text x="680" y="150" class="title">Dashboard React</text>
  <text x="680" y="172" class="text">• Vite/React + Tailwind</text>
  <text x="680" y="190" class="text">• Consulta API e WebSocket/SSE</text>
  <text x="680" y="208" class="text">• Gestão: cadastro, tickets, alertas</text>

  <!-- Arrows -->
  <line x1="300" y1="190" x2="360" y2="190" class="arrow" />
  <text x="310" y="176" class="text">HTTPS + Bearer</text>

  <line x1="490" y1="280" x2="490" y2="320" class="arrow" />
  <text x="496" y="304" class="text">ORM (SQLAlchemy)</text>

  <line x1="620" y1="170" x2="660" y2="170" class="arrow" />
  <text x="624" y="156" class="text">HTTPS</text>

  <!-- Reverse Proxy -->
  <rect x="270" y="20" width="420" height="50" class="box" />
  <text x="290" y="50" class="text">Reverse Proxy/LB (Nginx/Cloud) — TLS 1.2+, HSTS, TLS Termination, Rate Limiting</text>

  <!-- Notes -->
  <text x="20" y="560" class="text">Observações: Pinning CA opcional para agentes; Idempotência por X-Idempotency-Key; Rotação de tokens; Alertas entregues via e-mail/Slack/SMS.</text>
</svg>