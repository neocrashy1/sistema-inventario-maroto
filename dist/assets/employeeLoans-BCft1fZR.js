import{l as e}from"./index-Dur0lEaU.js";import{b as t,r as a,c as o}from"./vue-vendor-BY5hdAT7.js";const n=t("employeeLoans",()=>{const t=a([{id:1,code:"EMP001",employee:{id:1,name:"João Silva",email:"joao.silva@empresa.com",department:"TI",position:"Desenvolvedor Senior"},asset:{id:1,name:"Notebook Dell Latitude 5520",code:"NB001",category:"Informática",serialNumber:"DL123456789"},loanDate:"2024-01-15",expectedReturnDate:"2024-02-15",returnDate:null,status:"Ativo",notes:"Empréstimo para trabalho remoto durante projeto especial",condition:null,returnNotes:null,createdAt:"2024-01-15T09:00:00Z",updatedAt:"2024-01-15T09:00:00Z"},{id:2,code:"EMP002",employee:{id:2,name:"Maria Santos",email:"maria.santos@empresa.com",department:"Marketing",position:"Coordenadora de Marketing"},asset:{id:2,name:"Câmera Canon EOS R6",code:"CAM001",category:"Audiovisual",serialNumber:"CN987654321"},loanDate:"2024-01-10",expectedReturnDate:"2024-01-20",returnDate:"2024-01-18",status:"Devolvido",notes:"Para evento de lançamento de produto",condition:"Perfeito",returnNotes:"Devolvido em perfeitas condições após evento",createdAt:"2024-01-10T14:30:00Z",updatedAt:"2024-01-18T16:45:00Z"},{id:3,code:"EMP003",employee:{id:3,name:"Carlos Lima",email:"carlos.lima@empresa.com",department:"Vendas",position:"Gerente de Vendas"},asset:{id:3,name:"Tablet iPad Pro",code:"TAB001",category:"Informática",serialNumber:"IP456789123"},loanDate:"2024-01-05",expectedReturnDate:"2024-01-12",returnDate:null,status:"Em Atraso",notes:"Para apresentações de vendas em clientes",condition:null,returnNotes:null,createdAt:"2024-01-05T11:15:00Z",updatedAt:"2024-01-05T11:15:00Z"},{id:4,code:"EMP004",employee:{id:4,name:"Ana Costa",email:"ana.costa@empresa.com",department:"Administração",position:"Analista Administrativo"},asset:{id:4,name:"Projetor Epson PowerLite",code:"PROJ001",category:"Audiovisual",serialNumber:"EP789123456"},loanDate:"2024-01-20",expectedReturnDate:"2024-01-25",returnDate:null,status:"Ativo",notes:"Para treinamento de equipe",condition:null,returnNotes:null,createdAt:"2024-01-20T08:30:00Z",updatedAt:"2024-01-20T08:30:00Z"}]),n=a([{id:1,name:"João Silva",email:"joao.silva@empresa.com",department:"TI",position:"Desenvolvedor Senior"},{id:2,name:"Maria Santos",email:"maria.santos@empresa.com",department:"Marketing",position:"Coordenadora de Marketing"},{id:3,name:"Carlos Lima",email:"carlos.lima@empresa.com",department:"Vendas",position:"Gerente de Vendas"},{id:4,name:"Ana Costa",email:"ana.costa@empresa.com",department:"Administração",position:"Analista Administrativo"},{id:5,name:"Pedro Oliveira",email:"pedro.oliveira@empresa.com",department:"RH",position:"Analista de RH"},{id:6,name:"Fernanda Rocha",email:"fernanda.rocha@empresa.com",department:"Financeiro",position:"Analista Financeiro"},{id:7,name:"Roberto Silva",email:"roberto.silva@empresa.com",department:"TI",position:"Analista de Sistemas"},{id:8,name:"Luciana Mendes",email:"luciana.mendes@empresa.com",department:"Atendimento",position:"Atendente"}]),s=a([{id:1,name:"Notebook Dell Latitude 5520",code:"NB001",category:"Informática",status:"Disponível"},{id:2,name:"Câmera Canon EOS R6",code:"CAM001",category:"Audiovisual",status:"Disponível"},{id:3,name:"Tablet iPad Pro",code:"TAB001",category:"Informática",status:"Emprestado"},{id:4,name:"Projetor Epson PowerLite",code:"PROJ001",category:"Audiovisual",status:"Emprestado"},{id:5,name:"Monitor LG UltraWide",code:"MON001",category:"Informática",status:"Disponível"},{id:6,name:"Impressora HP LaserJet",code:"IMP001",category:"Informática",status:"Disponível"},{id:7,name:"Smartphone Samsung Galaxy",code:"CEL001",category:"Comunicação",status:"Disponível"}]),r=a(!1),i=a(null),l=o(()=>t.value.length),d=o(()=>t.value.filter(e=>"Ativo"===e.status)),u=o(()=>{const e=new Date;return t.value.filter(t=>{if("Ativo"!==t.status)return!1;return new Date(t.expectedReturnDate)<e})}),m=o(()=>t.value.filter(e=>"Devolvido"===e.status)),c=o(()=>{const e={};return t.value.forEach(t=>{const a=t.employee.department;e[a]||(e[a]=0),e[a]++}),e}),v=o(()=>{const e={};return t.value.forEach(t=>{e[t.status]||(e[t.status]=0),e[t.status]++}),e}),p=o(()=>t.value.filter(e=>"Ativo"===e.status).map(e=>e.asset.id)),D=o(()=>s.value.filter(e=>"Disponível"===e.status&&!p.value.includes(e.id))),w=(e,a)=>e||a?t.value.filter(t=>{const o=new Date(t.loanDate),n=e?new Date(e):new Date("1900-01-01"),s=a?new Date(a):new Date("2100-12-31");return o>=n&&o<=s}):t.value,f=e=>[["Código","Funcionário","Email","Departamento","Ativo","Código Ativo","Data Empréstimo","Data Prevista","Data Devolução","Status","Condição","Observações"],...e.map(e=>[e.code,e.employee.name,e.employee.email,e.employee.department,e.asset.name,e.asset.code,e.loanDate,e.expectedReturnDate,e.returnDate||"",e.status,e.condition||"",e.notes])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),A=(e,t,a)=>{const o=new Blob([e],{type:a}),n=window.URL.createObjectURL(o),s=document.createElement("a");s.href=n,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(n)};return{loans:t,employees:n,availableAssets:s,loading:r,error:i,totalLoans:l,activeLoans:d,overdueLoans:u,returnedLoans:m,loansByDepartment:c,loansByStatus:v,assetsOnLoan:p,availableAssetsForLoan:D,fetchLoans:async()=>{r.value=!0,i.value=null;try{await new Promise(e=>setTimeout(e,1e3)),r.value=!1}catch(e){throw i.value=e.message,r.value=!1,e}},createLoan:async e=>{r.value=!0,i.value=null;try{const a=n.value.find(t=>t.id===e.employeeId),o=s.value.find(t=>t.id===e.assetId);if(!a)throw new Error("Funcionário não encontrado");if(!o)throw new Error("Ativo não encontrado");if("Disponível"!==o.status)throw new Error("Ativo não está disponível para empréstimo");if(t.value.filter(t=>t.employee.id===e.employeeId&&"Ativo"===t.status).length>=3)throw new Error("Funcionário já possui o limite máximo de empréstimos ativos (3)");await new Promise(e=>setTimeout(e,500));const i={id:Date.now(),code:`EMP${String(t.value.length+1).padStart(3,"0")}`,employee:a,asset:o,loanDate:e.loanDate,expectedReturnDate:e.expectedReturnDate,returnDate:null,status:"Ativo",notes:e.notes||"",condition:null,returnNotes:null,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};t.value.push(i);const l=s.value.findIndex(t=>t.id===e.assetId);return-1!==l&&(s.value[l].status="Emprestado"),r.value=!1,i}catch(a){throw i.value=a.message,r.value=!1,a}},returnLoan:async(e,a)=>{r.value=!0,i.value=null;try{await new Promise(e=>setTimeout(e,500));const o=t.value.findIndex(t=>t.id===e);if(-1===o)throw new Error("Empréstimo não encontrado");const n=t.value[o];if("Ativo"!==n.status)throw new Error("Este empréstimo não está ativo");t.value[o]={...n,returnDate:a.returnDate,status:"Devolvido",condition:a.condition,returnNotes:a.returnNotes||"",updatedAt:(new Date).toISOString()};const i=s.value.findIndex(e=>e.id===n.asset.id);return-1!==i&&(s.value[i].status="Disponível"),r.value=!1,t.value[o]}catch(o){throw i.value=o.message,r.value=!1,o}},updateLoan:async(e,a)=>{r.value=!0,i.value=null;try{await new Promise(e=>setTimeout(e,500));const o=t.value.findIndex(t=>t.id===e);if(-1===o)throw new Error("Empréstimo não encontrado");return t.value[o]={...t.value[o],...a,updatedAt:(new Date).toISOString()},r.value=!1,t.value[o]}catch(o){throw i.value=o.message,r.value=!1,o}},cancelLoan:async(e,a)=>{r.value=!0,i.value=null;try{await new Promise(e=>setTimeout(e,500));const o=t.value.findIndex(t=>t.id===e);if(-1===o)throw new Error("Empréstimo não encontrado");const n=t.value[o];if("Ativo"!==n.status)throw new Error("Apenas empréstimos ativos podem ser cancelados");t.value[o]={...n,status:"Cancelado",returnNotes:a,updatedAt:(new Date).toISOString()};const i=s.value.findIndex(e=>e.id===n.asset.id);return-1!==i&&(s.value[i].status="Disponível"),r.value=!1,t.value[o]}catch(o){throw i.value=o.message,r.value=!1,o}},getLoanById:e=>t.value.find(t=>t.id===e),getLoansByEmployee:e=>t.value.filter(t=>t.employee.id===e),getLoansByAsset:e=>t.value.filter(t=>t.asset.id===e),searchLoans:e=>{if(!e)return t.value;const a=e.toLowerCase();return t.value.filter(e=>e.code.toLowerCase().includes(a)||e.employee.name.toLowerCase().includes(a)||e.employee.email.toLowerCase().includes(a)||e.asset.name.toLowerCase().includes(a)||e.asset.code.toLowerCase().includes(a)||e.notes.toLowerCase().includes(a))},filterLoansByStatus:e=>e?t.value.filter(t=>t.status===e):t.value,filterLoansByDepartment:e=>e?t.value.filter(t=>t.employee.department===e):t.value,filterLoansByDateRange:w,getOverdueLoans:()=>{const e=new Date;return t.value.filter(t=>{if("Ativo"!==t.status)return!1;return new Date(t.expectedReturnDate)<e})},updateOverdueStatus:()=>{const e=new Date;t.value.forEach(t=>{if("Ativo"===t.status){new Date(t.expectedReturnDate)<e&&(t.status="Em Atraso",t.updatedAt=(new Date).toISOString())}})},exportLoans:async(a="csv",o={})=>{try{r.value=!0;let n=t.value;if(o.status&&(n=n.filter(e=>e.status===o.status)),o.department&&(n=n.filter(e=>e.employee.department===o.department)),(o.startDate||o.endDate)&&(n=w(o.startDate,o.endDate)),await new Promise(e=>setTimeout(e,1e3)),"csv"===a){const e=f(n);A(e,"emprestimos-funcionarios.csv","text/csv")}else"excel"===a&&e.debug("Exportação para Excel não implementada ainda");return r.value=!1,!0}catch(n){throw i.value=n.message,r.value=!1,n}},clearError:()=>{i.value=null}}});export{n as u};
//# sourceMappingURL=employeeLoans-BCft1fZR.js.map
