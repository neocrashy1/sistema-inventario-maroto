import{b as e}from"./vue-vendor-BY5hdAT7.js";const t=e("serviceOrders",{state:()=>({orders:[{id:1,code:"OS-2024-001",title:"Manutenção Preventiva - Notebook",description:"Limpeza interna, atualização de drivers e verificação de hardware",type:"preventive",priority:"medium",status:"completed",assetId:1,assetCode:"NB-001",assetName:"Notebook Dell Latitude",assignedTo:"João Silva",department:"TI",createdAt:"2024-01-15T08:00:00Z",dueDate:"2024-01-20T17:00:00Z",startedAt:"2024-01-16T09:00:00Z",completedAt:"2024-01-19T16:30:00Z",notes:"Manutenção preventiva conforme cronograma",resolution:"Limpeza realizada, drivers atualizados, hardware funcionando perfeitamente.",estimatedHours:2,actualHours:1.5,cost:0},{id:2,code:"OS-2024-002",title:"Reparo - Monitor com Defeito",description:"Monitor apresentando falhas na imagem, necessário diagnóstico e reparo",type:"corrective",priority:"high",status:"in_progress",assetId:2,assetCode:"MON-015",assetName:'Monitor Samsung 24"',assignedTo:"Maria Santos",department:"TI",createdAt:"2024-02-01T10:30:00Z",dueDate:"2024-02-05T17:00:00Z",startedAt:"2024-02-02T08:00:00Z",completedAt:null,notes:"Usuário relatou falhas intermitentes na imagem",resolution:null,estimatedHours:4,actualHours:2,cost:150},{id:3,code:"OS-2024-003",title:"Emergência - Servidor Principal",description:"Servidor principal apresentando instabilidade, necessário intervenção imediata",type:"emergency",priority:"urgent",status:"open",assetId:3,assetCode:"SRV-001",assetName:"Servidor Dell PowerEdge",assignedTo:"Carlos Oliveira",department:"TI",createdAt:"2024-02-10T14:45:00Z",dueDate:"2024-02-10T18:00:00Z",startedAt:null,completedAt:null,notes:"Problema crítico afetando operações",resolution:null,estimatedHours:6,actualHours:0,cost:0},{id:4,code:"OS-2024-004",title:"Instalação - Novo Software",description:"Instalação e configuração de novo software de gestão",type:"preventive",priority:"low",status:"open",assetId:4,assetCode:"CPU-025",assetName:"Desktop HP ProDesk",assignedTo:"Ana Costa",department:"TI",createdAt:"2024-02-08T11:00:00Z",dueDate:"2024-02-15T17:00:00Z",startedAt:null,completedAt:null,notes:"Instalação agendada para próxima semana",resolution:null,estimatedHours:3,actualHours:0,cost:0},{id:5,code:"OS-2024-005",title:"Substituição - Disco Rígido",description:"Substituição de disco rígido com falhas por SSD",type:"corrective",priority:"high",status:"open",assetId:5,assetCode:"NB-002",assetName:"Notebook Lenovo ThinkPad",assignedTo:"João Silva",department:"TI",createdAt:"2024-02-09T09:15:00Z",dueDate:"2024-02-12T17:00:00Z",startedAt:null,completedAt:null,notes:"Disco apresentando setores defeituosos",resolution:null,estimatedHours:2,actualHours:0,cost:300}],technicians:[{id:1,name:"João Silva",department:"TI",specialties:["Hardware","Redes"]},{id:2,name:"Maria Santos",department:"TI",specialties:["Software","Sistemas"]},{id:3,name:"Carlos Oliveira",department:"TI",specialties:["Servidores","Infraestrutura"]},{id:4,name:"Ana Costa",department:"TI",specialties:["Software","Treinamento"]},{id:5,name:"Pedro Alves",department:"Manutenção",specialties:["Elétrica","Mecânica"]}],availableAssets:[{id:1,code:"NB-001",name:"Notebook Dell Latitude",category:"Informática",location:"Sala 101"},{id:2,code:"MON-015",name:'Monitor Samsung 24"',category:"Informática",location:"Sala 102"},{id:3,code:"SRV-001",name:"Servidor Dell PowerEdge",category:"Infraestrutura",location:"Data Center"},{id:4,code:"CPU-025",name:"Desktop HP ProDesk",category:"Informática",location:"Sala 201"},{id:5,code:"NB-002",name:"Notebook Lenovo ThinkPad",category:"Informática",location:"Sala 105"}],loading:!1,error:null,searchTerm:"",filters:{status:"",priority:"",type:"",assignedTo:"",dateRange:{start:"",end:""}}}),getters:{totalOrders:e=>e.orders.length,ordersInProgress:e=>e.orders.filter(e=>"in_progress"===e.status).length,overdueOrders:e=>{const t=new Date;return e.orders.filter(e=>"completed"!==e.status&&"cancelled"!==e.status&&new Date(e.dueDate)<t).length},completedOrders:e=>e.orders.filter(e=>"completed"===e.status).length,ordersByStatus:e=>e.orders.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),ordersByType:e=>e.orders.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{}),ordersByPriority:e=>e.orders.reduce((e,t)=>(e[t.priority]=(e[t.priority]||0)+1,e),{}),ordersByTechnician:e=>e.orders.reduce((e,t)=>(e[t.assignedTo]=(e[t.assignedTo]||0)+1,e),{}),averageResolutionTime:e=>{const t=e.orders.filter(e=>"completed"===e.status&&e.startedAt&&e.completedAt);if(0===t.length)return 0;const r=t.reduce((e,t)=>{const r=new Date(t.startedAt);return e+(new Date(t.completedAt)-r)/36e5},0);return Math.round(r/t.length*10)/10},totalCost:e=>e.orders.reduce((e,t)=>e+(t.cost||0),0),filteredOrders:e=>{let t=[...e.orders];if(e.searchTerm){const r=e.searchTerm.toLowerCase();t=t.filter(e=>e.code.toLowerCase().includes(r)||e.title.toLowerCase().includes(r)||e.description.toLowerCase().includes(r)||e.assignedTo.toLowerCase().includes(r)||e.assetCode.toLowerCase().includes(r)||e.assetName.toLowerCase().includes(r))}return e.filters.status&&(t=t.filter(t=>t.status===e.filters.status)),e.filters.priority&&(t=t.filter(t=>t.priority===e.filters.priority)),e.filters.type&&(t=t.filter(t=>t.type===e.filters.type)),e.filters.assignedTo&&(t=t.filter(t=>t.assignedTo===e.filters.assignedTo)),e.filters.dateRange.start&&e.filters.dateRange.end&&(t=t.filter(t=>{const r=new Date(t.createdAt),a=new Date(e.filters.dateRange.start),s=new Date(e.filters.dateRange.end);return r>=a&&r<=s})),t.sort((e,t)=>{const r={urgent:4,high:3,medium:2,low:1},a=r[t.priority]-r[e.priority];return 0!==a?a:new Date(t.createdAt)-new Date(e.createdAt)})}},actions:{async fetchOrders(){this.loading=!0,this.error=null;try{await new Promise(e=>setTimeout(e,1e3)),this.loading=!1}catch(e){throw this.error="Erro ao carregar ordens de serviço",this.loading=!1,e}},async createOrder(e){this.loading=!0,this.error=null;try{await new Promise(e=>setTimeout(e,500));const t=this.availableAssets.find(t=>t.id===parseInt(e.assetId)),r=this.technicians.find(t=>t.name===e.assignedTo),a={id:Date.now(),code:`OS-${(new Date).getFullYear()}-${String(this.orders.length+1).padStart(3,"0")}`,...e,assetCode:(null==t?void 0:t.code)||"",assetName:(null==t?void 0:t.name)||"",department:(null==r?void 0:r.department)||"TI",status:"open",createdAt:(new Date).toISOString(),startedAt:null,completedAt:null,resolution:null,estimatedHours:0,actualHours:0,cost:0};return this.orders.unshift(a),this.loading=!1,a}catch(t){throw this.error="Erro ao criar ordem de serviço",this.loading=!1,t}},async updateOrder(e,t){this.loading=!0,this.error=null;try{await new Promise(e=>setTimeout(e,500));const r=this.orders.findIndex(t=>t.id===e);if(-1!==r){if(t.assetId){const e=this.availableAssets.find(e=>e.id===parseInt(t.assetId));e&&(t.assetCode=e.code,t.assetName=e.name)}if(t.assignedTo){const e=this.technicians.find(e=>e.name===t.assignedTo);e&&(t.department=e.department)}this.orders[r]={...this.orders[r],...t}}this.loading=!1}catch(r){throw this.error="Erro ao atualizar ordem de serviço",this.loading=!1,r}},async startOrder(e){await this.updateOrder(e,{status:"in_progress",startedAt:(new Date).toISOString()})},async completeOrder(e,t=""){await this.updateOrder(e,{status:"completed",completedAt:(new Date).toISOString(),resolution:t||"Ordem concluída com sucesso."})},async cancelOrder(e,t=""){await this.updateOrder(e,{status:"cancelled",resolution:t||"Ordem cancelada."})},async deleteOrder(e){this.loading=!0,this.error=null;try{await new Promise(e=>setTimeout(e,500));const t=this.orders.findIndex(t=>t.id===e);-1!==t&&this.orders.splice(t,1),this.loading=!1}catch(t){throw this.error="Erro ao deletar ordem de serviço",this.loading=!1,t}},setSearchTerm(e){this.searchTerm=e},setFilters(e){this.filters={...this.filters,...e}},clearFilters(){this.filters={status:"",priority:"",type:"",assignedTo:"",dateRange:{start:"",end:""}},this.searchTerm=""},async exportOrders(e="csv"){try{const t=this.filteredOrders;if("csv"===e){const e=this.generateCSV(t);this.downloadFile(e,`ordens_servico_${(new Date).toISOString().split("T")[0]}.csv`,"text/csv")}return!0}catch(t){throw this.error="Erro ao exportar dados",t}},generateCSV(e){return[["Código","Título","Descrição","Tipo","Prioridade","Status","Ativo","Técnico","Departamento","Data Criação","Data Vencimento","Data Início","Data Conclusão","Horas Estimadas","Horas Reais","Custo","Observações","Resolução"],...e.map(e=>[e.code,e.title,e.description,this.getTypeLabel(e.type),this.getPriorityLabel(e.priority),this.getStatusLabel(e.status),`${e.assetCode} - ${e.assetName}`,e.assignedTo,e.department,new Date(e.createdAt).toLocaleString("pt-BR"),new Date(e.dueDate).toLocaleString("pt-BR"),e.startedAt?new Date(e.startedAt).toLocaleString("pt-BR"):"",e.completedAt?new Date(e.completedAt).toLocaleString("pt-BR"):"",e.estimatedHours,e.actualHours,e.cost,e.notes||"",e.resolution||""])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")},downloadFile(e,t,r){const a=new Blob([e],{type:r}),s=window.URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(s)},getStatusLabel:e=>({open:"Aberta",in_progress:"Em Andamento",completed:"Concluída",cancelled:"Cancelada"}[e]||e),getTypeLabel:e=>({preventive:"Preventiva",corrective:"Corretiva",emergency:"Emergencial"}[e]||e),getPriorityLabel:e=>({low:"Baixa",medium:"Média",high:"Alta",urgent:"Urgente"}[e]||e),getStatusColor:e=>({open:"blue",in_progress:"orange",completed:"green",cancelled:"gray"}[e]||"gray"),getPriorityColor:e=>({low:"blue",medium:"yellow",high:"red",urgent:"purple"}[e]||"gray"),getOrdersThisMonth(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);return this.orders.filter(e=>new Date(e.createdAt)>=t).length},getCompletionRate(){const e=this.orders.length;if(0===e)return 0;const t=this.orders.filter(e=>"completed"===e.status).length;return Math.round(t/e*100)},getAverageResponseTime(){const e=this.orders.filter(e=>e.startedAt&&e.createdAt);if(0===e.length)return 0;const t=e.reduce((e,t)=>{const r=new Date(t.createdAt);return e+(new Date(t.startedAt)-r)/36e5},0);return Math.round(t/e.length*10)/10}}});export{t as u};
//# sourceMappingURL=serviceOrders-nzPMGKta.js.map
