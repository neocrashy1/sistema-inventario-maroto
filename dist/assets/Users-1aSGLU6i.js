import{b as e,r as a,c as s,H as t,w as l,e as r,k as o,x as n,f as i,D as u,B as d,y as c,F as m,C as v,o as p,z as f,m as h,K as y,an as g,I as b,L as k,u as w,g as C,ao as U}from"./vue-vendor-BY5hdAT7.js";import{c as A,l as E,d as I,a as V,e as S,_ as F}from"./index-Dur0lEaU.js";import{u as x,L as B}from"./LoadingState-Bai_lHj2.js";import"./utils-vendor-COuxBHZ0.js";const j=e("users",()=>{const{handleError:e}=S(),{showSuccess:t,showError:l}=V(),{invalidateAfterCreate:r,invalidateAfterUpdate:o,invalidateAfterDelete:n}=function(){const{invalidateCache:e,invalidatePattern:a,clearCache:s}=A(),t=()=>{E.info("Invalidating users cache"),a("users:"),e("dashboard:stats")},l=()=>{E.info("Invalidating locations cache"),a("locations:"),e("dashboard:stats")},r=()=>{E.info("Invalidating machines cache"),a("machines:"),e("dashboard:stats"),e("dashboard:metrics")},o=()=>{E.info("Invalidating tickets cache"),a("tickets:"),e("dashboard:alerts"),e("dashboard:stats")},n=()=>{E.info("Invalidating alerts cache"),a("alerts:"),e("dashboard:alerts")},i=(a,s,i=null)=>{switch(E.info("Cache invalidation triggered",{operation:a,entityType:s,entityId:i}),s){case"user":t(),i&&e(`users:${i}`);break;case"location":l(),i&&e(`locations:${i}`);break;case"machine":r(),i&&e(`machines:${i}:status`);break;case"ticket":o(),i&&e(`tickets:${i}`);break;case"alert":n(),i&&e(`alerts:${i}`);break;default:E.warn("Unknown entity type for cache invalidation",{entityType:s})}["create","update","delete"].includes(a)&&e("dashboard:stats")},u=()=>{E.warn("Clearing all cache"),s()};return{invalidateUsersCache:t,invalidateLocationsCache:l,invalidateMachinesCache:r,invalidateTicketsCache:o,invalidateAlertsCache:n,invalidateDashboardCache:()=>{E.info("Invalidating dashboard cache"),a("dashboard:")},invalidateReportsCache:()=>{E.info("Invalidating reports cache"),a("reports:"),a("analytics:")},invalidateSettingsCache:()=>{E.info("Invalidating settings cache"),a("settings:"),u()},invalidateByOperation:i,invalidateAfterCreate:(e,a=null)=>{i("create",e,null==a?void 0:a.id)},invalidateAfterUpdate:(e,a)=>{i("update",e,a)},invalidateAfterDelete:(e,a)=>{i("delete",e,a)},clearAllCache:u,invalidateCache:e,invalidatePattern:a,clearCache:s}}(),i=a([{id:1,name:"Administrador",email:"admin@levitiis.com",username:"admin",role:"admin",department:"TI",status:"active",avatar:null,permissions:["all"],createdAt:new Date("2024-01-01"),lastLogin:new Date,phone:"(11) 99999-9999"},{id:2,name:"João Silva",email:"joao.silva@levitiis.com",username:"joao.silva",role:"manager",department:"Patrimônio",status:"active",avatar:null,permissions:["assets.read","assets.write","reports.read","inventory.read","inventory.write"],createdAt:new Date("2024-01-15"),lastLogin:new Date("2024-01-20"),phone:"(11) 98888-8888"},{id:3,name:"Maria Santos",email:"maria.santos@levitiis.com",username:"maria.santos",role:"user",department:"Financeiro",status:"active",avatar:null,permissions:["assets.read","reports.read"],createdAt:new Date("2024-01-20"),lastLogin:new Date("2024-01-19"),phone:"(11) 97777-7777"},{id:4,name:"Pedro Costa",email:"pedro.costa@levitiis.com",username:"pedro.costa",role:"user",department:"RH",status:"inactive",avatar:null,permissions:["assets.read"],createdAt:new Date("2024-01-10"),lastLogin:new Date("2024-01-15"),phone:"(11) 96666-6666"}]),u=a([{id:"admin",name:"Administrador",description:"Acesso total ao sistema",permissions:["all"],color:"#dc2626"},{id:"manager",name:"Gerente",description:"Acesso de gerenciamento",permissions:["assets.read","assets.write","assets.delete","inventory.read","inventory.write","reports.read","reports.write","audits.read","audits.write","users.read"],color:"#ea580c"},{id:"user",name:"Usuário",description:"Acesso básico de leitura",permissions:["assets.read","reports.read","inventory.read"],color:"#2563eb"},{id:"auditor",name:"Auditor",description:"Acesso para auditoria",permissions:["assets.read","inventory.read","inventory.write","audits.read","audits.write","reports.read"],color:"#7c3aed"}]),d=a(["TI","Patrimônio","Financeiro","RH","Operações","Auditoria","Compras"]),c=a([{id:"assets.read",name:"Visualizar Ativos",category:"Ativos"},{id:"assets.write",name:"Editar Ativos",category:"Ativos"},{id:"assets.delete",name:"Excluir Ativos",category:"Ativos"},{id:"inventory.read",name:"Visualizar Inventário",category:"Inventário"},{id:"inventory.write",name:"Editar Inventário",category:"Inventário"},{id:"reports.read",name:"Visualizar Relatórios",category:"Relatórios"},{id:"reports.write",name:"Criar Relatórios",category:"Relatórios"},{id:"audits.read",name:"Visualizar Auditorias",category:"Auditorias"},{id:"audits.write",name:"Realizar Auditorias",category:"Auditorias"},{id:"users.read",name:"Visualizar Usuários",category:"Usuários"},{id:"users.write",name:"Gerenciar Usuários",category:"Usuários"},{id:"settings.read",name:"Visualizar Configurações",category:"Sistema"},{id:"settings.write",name:"Alterar Configurações",category:"Sistema"},{id:"all",name:"Acesso Total",category:"Sistema"}]),m=s(()=>i.value.filter(e=>"active"===e.status)),v=s(()=>i.value.filter(e=>"inactive"===e.status)),p=s(()=>{const e={};return u.value.forEach(a=>{e[a.id]=i.value.filter(e=>e.role===a.id)}),e});function f(e){return i.value.find(a=>a.id===e)}return{users:i,roles:u,departments:d,permissions:c,activeUsers:m,inactiveUsers:v,usersByRole:p,addUser:async function(a){try{const e=(await I.create(a)).data;return i.value.push(e),r("user",e),t(`Usuário ${e.name} criado com sucesso`),e}catch(s){throw e(s,"Erro ao criar usuário"),s}},updateUser:async function(a,s){try{const e=(await I.update(a,s)).data,l=i.value.findIndex(e=>e.id===a);return-1!==l&&(i.value[l]={...i.value[l],...e}),o("user",a),t(`Usuário ${e.name} atualizado com sucesso`),e}catch(l){throw e(l,"Erro ao atualizar usuário"),l}},deleteUser:async function(a){try{const e=i.value.find(e=>e.id===a);if(!e)return l("Usuário não encontrado"),!1;await I.delete(a);const s=i.value.findIndex(e=>e.id===a);return-1!==s&&i.value.splice(s,1),n("user",a),t(`Usuário ${e.name} removido com sucesso`),!0}catch(s){throw e(s,"Erro ao remover usuário"),s}},getUserById:f,getUsersByDepartment:function(e){return i.value.filter(a=>a.department===e)},toggleUserStatus:function(e){const a=f(e);return a?(a.status="active"===a.status?"inactive":"active",a):null},getRoleById:function(e){return u.value.find(a=>a.id===e)},updateUserLastLogin:function(e){const a=f(e);a&&(a.lastLogin=new Date)},hasPermission:function(e,a){const s=f(e);return!!s&&(!!s.permissions.includes("all")||s.permissions.includes(a))},getUserPermissions:function(e){const a=f(e);return a?a.permissions.includes("all")?c.value.map(e=>e.id):a.permissions:[]},resetUserPassword:function(e,a){const s=f(e);return!!s&&(s.passwordResetAt=new Date,s.temporaryPassword=!0,!0)}}}),D=e=>null!=e&&""!==e||"Este campo é obrigatório",L=e=>a=>!a||(!(a.length<e)||`Deve ter pelo menos ${e} caracteres`),R=e=>a=>!a||(!(a.length>e)||`Deve ter no máximo ${e} caracteres`);function $(e,a){for(const s of a){const a=s(e);if(!0!==a)return a}return!0}function P(e={},r={}){const o=t({...e}),n=t({}),i=t({}),u=a(!1),d=s(()=>0===Object.keys(n).length),c=s(()=>Object.keys(i).some(e=>i[e])),m=s(()=>d.value&&c.value&&!u.value),v=(e,a=o[e])=>{const s=r[e];if(!s)return!0;const t=$(a,s);return!0===t?delete n[e]:n[e]=t,!0===t},p=()=>{u.value=!0;const e=function(e,a){const s={};for(const[t,l]of Object.entries(a)){const a=$(e[t],l);!0!==a&&(s[t]=a)}return{isValid:0===Object.keys(s).length,errors:s}}(o,r);return Object.keys(n).forEach(e=>delete n[e]),Object.assign(n,e.errors),Object.keys(r).forEach(e=>{i[e]=!0}),u.value=!1,e.isValid},f=e=>{i[e]=!0},h=(e,a=!1)=>l(()=>o[e],s=>{(i[e]||a)&&v(e,s)},{immediate:a});return{formData:o,errors:n,touched:i,isValidating:u,isValid:d,hasBeenTouched:c,canSubmit:m,validateSingleField:v,validateAllFields:p,touchField:f,clearFieldError:e=>{delete n[e]},clearAllErrors:()=>{Object.keys(n).forEach(e=>delete n[e])},resetForm:(a=e)=>{Object.keys(o).forEach(e=>delete o[e]),Object.assign(o,{...a}),Object.keys(n).forEach(e=>delete n[e]),Object.keys(i).forEach(e=>delete i[e]),u.value=!1},updateFormData:e=>{Object.assign(o,e)},getFieldClass:e=>{const a=["form-input"];return i[e]&&(n[e]?a.push("form-input--error"):a.push("form-input--success")),a.join(" ")},getFieldError:e=>i[e]?n[e]:null,hasFieldError:e=>i[e]&&!!n[e],isFieldValid:e=>i[e]&&!n[e],handleFieldBlur:e=>{f(e),v(e)},handleFieldInput:(e,a)=>{o[e]=a,i[e]&&v(e,a)},setupRealtimeValidation:h,setupAllRealtimeValidation:(e=!1)=>{const a=[];return Object.keys(r).forEach(s=>{const t=h(s,e);a.push(t)}),a},submitForm:async e=>{if(!p())return{success:!1,errors:n};try{u.value=!0;return{success:!0,data:await e(o)}}catch(a){return{success:!1,error:a.message}}finally{u.value=!1}}}}const T=(e=[])=>a=>{var s;if(!a)return"Email é obrigatório";const t=(e=>!e||(!!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||"Email inválido"))(a);if(!0!==t)return t;if(e.length>0){const t=null==(s=a.split("@")[1])?void 0:s.toLowerCase();if(!e.some(e=>t===e.toLowerCase()))return`Email deve ser de um dos domínios: ${e.join(", ")}`}return!0},z=e=>{if(!e)return"Senha é obrigatória";const a=L(8)(e);if(!0!==a)return a;const s=R(128)(e);return!0!==s?s:/[a-z]/.test(e)?/[A-Z]/.test(e)?/\d/.test(e)?!!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)||"Senha deve conter pelo menos um caractere especial":"Senha deve conter pelo menos um número":"Senha deve conter pelo menos uma letra maiúscula":"Senha deve conter pelo menos uma letra minúscula"},O=e=>a=>a?a===e||"Senhas não coincidem":"Confirmação de senha é obrigatória",N={name:[e=>{if(!e)return"Nome completo é obrigatório";const a=L(2)(e);if(!0!==a)return a;const s=R(100)(e);if(!0!==s)return s;if(!e.includes(" "))return"Digite o nome completo (nome e sobrenome)";return!!/^[a-zA-ZÀ-ÿ\s'-]+$/.test(e)||"Nome deve conter apenas letras, espaços e acentos"}],email:[T()],username:[e=>{if(!e)return"Nome de usuário é obrigatório";const a=L(3)(e);if(!0!==a)return a;const s=R(30)(e);if(!0!==s)return s;return/^[a-zA-Z0-9._-]+$/.test(e)?!/^[._-]|[._-]$/.test(e)||"Nome de usuário não pode começar ou terminar com ponto, hífen ou underscore":"Nome de usuário deve conter apenas letras, números, pontos, hífens e underscores"}],phone:[e=>{if(!e)return!0;const a=e.replace(/\D/g,"");if(a.length<10||a.length>11)return"Telefone deve ter 10 ou 11 dígitos";return!!/^(\(?\d{2}\)?\s?)?\d{4,5}-?\d{4}$/.test(e)||"Formato de telefone inválido. Use: (11) 99999-9999"}],role:[D],department:[D],status:[D]};const q={name:"FormField",props:{modelValue:{type:[String,Number,Boolean],default:""},label:{type:String,default:""},type:{type:String,default:"text"},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},errorMessage:{type:String,default:""},helpText:{type:String,default:""},showStatusIcon:{type:Boolean,default:!0},showError:{type:Boolean,default:!0},touched:{type:Boolean,default:!1},rows:{type:Number,default:3},options:{type:Array,default:()=>[]},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)}},emits:["update:modelValue","blur","focus"],setup(e,{emit:t}){const l=a(!1),r=s(()=>`field-${Math.random().toString(36).substr(2,9)}`),o=s(()=>e.touched&&!!e.errorMessage),n=s(()=>e.touched&&!e.errorMessage),i=s(()=>({"form-field--error":o.value,"form-field--valid":n.value,"form-field--focused":l.value,"form-field--disabled":e.disabled,"form-field--readonly":e.readonly,[`form-field--${e.size}`]:!0})),u=s(()=>({"form-input":!0,"form-input--error":o.value,"form-input--valid":n.value,"form-input--focused":l.value,"form-input--disabled":e.disabled,"form-input--readonly":e.readonly,[`form-input--${e.size}`]:!0}));return{fieldId:r,hasError:o,isValid:n,fieldClasses:i,inputClasses:u,handleInput:e=>{const a=e.target.value;t("update:modelValue",a)},handleBlur:e=>{l.value=!1,t("blur",e)},handleFocus:e=>{l.value=!0,t("focus",e)}}}},M=["for"],_={key:0,class:"required-indicator"},G={class:"form-input-container"},H=["id","type","value","placeholder","disabled","readonly"],Z=["id","value","placeholder","disabled","readonly","rows"],J=["id","value","disabled"],K={key:0,value:"",disabled:""},W=["value"],Q={key:3,class:"status-icon"},X={key:0,class:"fas fa-check-circle text-success"},Y={key:1,class:"fas fa-exclamation-circle text-error"},ee={key:1,class:"error-message"},ae={key:2,class:"help-text"};const se=F(q,[["render",function(e,a,s,t,l,p){return o(),r("div",{class:c(["form-field",t.fieldClasses])},[s.label?(o(),r("label",{key:0,for:t.fieldId,class:"form-label"},[u(d(s.label)+" ",1),s.required?(o(),r("span",_,"*")):n("",!0)],8,M)):n("",!0),i("div",G,["textarea"!==s.type&&"select"!==s.type?(o(),r("input",{key:0,id:t.fieldId,type:s.type,value:s.modelValue,placeholder:s.placeholder,disabled:s.disabled,readonly:s.readonly,class:c(t.inputClasses),onInput:a[0]||(a[0]=(...e)=>t.handleInput&&t.handleInput(...e)),onBlur:a[1]||(a[1]=(...e)=>t.handleBlur&&t.handleBlur(...e)),onFocus:a[2]||(a[2]=(...e)=>t.handleFocus&&t.handleFocus(...e))},null,42,H)):"textarea"===s.type?(o(),r("textarea",{key:1,id:t.fieldId,value:s.modelValue,placeholder:s.placeholder,disabled:s.disabled,readonly:s.readonly,rows:s.rows,class:c(t.inputClasses),onInput:a[3]||(a[3]=(...e)=>t.handleInput&&t.handleInput(...e)),onBlur:a[4]||(a[4]=(...e)=>t.handleBlur&&t.handleBlur(...e)),onFocus:a[5]||(a[5]=(...e)=>t.handleFocus&&t.handleFocus(...e))},null,42,Z)):"select"===s.type?(o(),r("select",{key:2,id:t.fieldId,value:s.modelValue,disabled:s.disabled,class:c(t.inputClasses),onChange:a[6]||(a[6]=(...e)=>t.handleInput&&t.handleInput(...e)),onBlur:a[7]||(a[7]=(...e)=>t.handleBlur&&t.handleBlur(...e)),onFocus:a[8]||(a[8]=(...e)=>t.handleFocus&&t.handleFocus(...e))},[s.placeholder?(o(),r("option",K,d(s.placeholder),1)):n("",!0),(o(!0),r(m,null,v(s.options,e=>(o(),r("option",{key:e.value,value:e.value},d(e.label),9,W))),128))],42,J)):n("",!0),s.showStatusIcon?(o(),r("div",Q,[t.isValid?(o(),r("i",X)):t.hasError?(o(),r("i",Y)):n("",!0)])):n("",!0)]),t.hasError&&s.showError?(o(),r("div",ee,[a[9]||(a[9]=i("i",{class:"fas fa-exclamation-triangle"},null,-1)),u(" "+d(s.errorMessage),1)])):n("",!0),s.helpText&&!t.hasError?(o(),r("div",ae,d(s.helpText),1)):n("",!0)],2)}],["__scopeId","data-v-fbe89850"]]),te={class:"users-admin"},le={class:"stats-grid"},re={class:"stat-card"},oe={class:"stat-content"},ne={class:"stat-card"},ie={class:"stat-content"},ue={class:"stat-card"},de={class:"stat-content"},ce={class:"stat-card"},me={class:"stat-content"},ve={class:"filters-section"},pe={class:"filters-grid"},fe={class:"filter-group"},he={class:"search-input"},ye={class:"filter-group"},ge=["value"],be={class:"filter-group"},ke=["value"],we={class:"filter-group"},Ce={class:"users-table-container"},Ue={class:"users-table"},Ae={class:"user-info"},Ee={class:"user-avatar"},Ie=["src","alt"],Ve={key:1,class:"fas fa-user"},Se={class:"user-details"},Fe={class:"user-name"},xe={class:"user-username"},Be={key:0,class:"last-login"},je={key:1,class:"no-login"},De={class:"action-buttons"},Le=["onClick"],Re=["onClick","title"],$e=["onClick"],Pe=["onClick"],Te={class:"modal-header"},ze={class:"modal-body"},Oe={class:"form-grid"},Ne={class:"permissions-section"},qe={class:"permissions-grid"},Me={class:"permission-items"},_e=["value"],Ge={class:"modal-actions"},He=["disabled"],Ze={key:0,class:"validation-summary"},Je={class:"modal-header"},Ke={class:"modal-body"},We={class:"modal-actions"},Qe={class:"modal-header"},Xe={class:"modal-body"},Ye={key:0,class:"password-result"},ea={class:"password-display"},aa={class:"modal-actions"},sa=F({__name:"Users",setup(e){const t=j(),{handleError:l}=S(),{showSuccess:A,showWarning:E}=V(),{isLoading:I,loadPage:F}=x(),L=a(""),R=a(""),$=a(""),q=a(""),M=a(!1),_=a(!1),G=a(!1),H=a(null),Z=a(null),J=a(null),K=a(""),W=a({name:"",email:"",username:"",phone:"",role:"",department:"",status:"active",permissions:[]}),Q=function(e={}){const{requirePassword:a=!1,corporateDomains:s=[],optionalFields:t=[]}=e;let l={...N};return s.length>0&&(l.email=[T(s)]),a&&(l.password=[z],l.passwordConfirmation=[O]),t.forEach(e=>{l[e]&&(l[e]=l[e].filter(e=>e!==D))}),l}({requirePassword:!1,optionalFields:["phone"]}),{errors:X,touched:Y,canSubmit:ee,validateAllFields:ae,clearAllErrors:sa,resetForm:ta,getFieldClass:la,getFieldError:ra,hasFieldError:oa,handleFieldBlur:na,handleFieldInput:ia,setupRealtimeValidation:ua}=P(W,Q),da=s(()=>{let e=t.users;if(L.value){const a=L.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(a)||e.email.toLowerCase().includes(a)||e.department.toLowerCase().includes(a)||e.username.toLowerCase().includes(a))}return R.value&&(e=e.filter(e=>e.role===R.value)),$.value&&(e=e.filter(e=>e.department===$.value)),q.value&&(e=e.filter(e=>e.status===q.value)),e}),ca=s(()=>{const e=new Set;return t.permissions.forEach(a=>{e.add(a.category)}),Array.from(e)});function ma(e){const a=t.getRoleById(e);return a?a.name:e}function va(e){const a=t.getRoleById(e);return a?a.color:"#6b7280"}function pa(e){return t.permissions.filter(a=>a.category===e)}function fa(e){return e?new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e)):""}function ha(){M.value=!0,ua()}function ya(){M.value=!1,H.value=null,W.value={name:"",email:"",username:"",phone:"",role:"",department:"",status:"active",permissions:[]},sa(),ta()}async function ga(){try{if(!(await ae()))return void E("Por favor, corrija os erros no formulário antes de continuar");H.value?await t.updateUser(H.value.id,W.value):await t.addUser(W.value),ya()}catch(e){l(e,"Erro ao salvar usuário")}}function ba(){try{t.deleteUser(Z.value.id),_.value=!1,Z.value=null}catch(e){l(e,"Erro ao excluir usuário")}}function ka(){try{const e=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%";let a="";for(let s=0;s<12;s++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}();t.resetUserPassword(J.value.id,e),K.value=e,A(`Senha do usuário ${J.value.name} foi resetada com sucesso!`)}catch(e){l(e,"Erro ao resetar senha do usuário")}}function wa(){G.value=!1,J.value=null,K.value=""}function Ca(){navigator.clipboard.writeText(K.value).then(()=>{A("Senha copiada para a área de transferência!")}).catch(e=>{l(e,"Erro ao copiar senha")})}function Ua(){try{const e=function(e){if(!e.length)return"";const a=Object.keys(e[0]),s=[a.join(","),...e.map(e=>a.map(a=>`"${e[a]||""}"`).join(","))].join("\n");return s}(da.value.map(e=>({Nome:e.name,Email:e.email,"Nome de Usuário":e.username,Perfil:ma(e.role),Departamento:e.department,Status:"active"===e.status?"Ativo":"Inativo","Criado em":fa(e.createdAt),"Último Login":e.lastLogin?fa(e.lastLogin):"Nunca logou"})));!function(e,a){const s=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),l=URL.createObjectURL(s);t.setAttribute("href",l),t.setAttribute("download",a),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)}(e,"usuarios.csv"),showSuccessMessage("Relatório exportado com sucesso!")}catch(e){showErrorMessage("Erro ao exportar dados")}}return p(()=>{F(()=>t.fetchUsers())}),(e,a)=>{var s,p;return o(),r("div",te,[i("div",{class:"page-header"},[a[36]||(a[36]=i("div",{class:"page-header-content"},[i("h1",{class:"page-title"},"Usuários"),i("p",{class:"page-subtitle"},"Gerenciamento de usuários e permissões do sistema")],-1)),i("div",{class:"page-actions"},[i("button",{class:"btn btn-secondary",onClick:Ua},[...a[34]||(a[34]=[i("i",{class:"fas fa-download"},null,-1),u(" Exportar ",-1)])]),i("button",{class:"btn btn-primary",onClick:ha},[...a[35]||(a[35]=[i("i",{class:"fas fa-plus"},null,-1),u(" Novo Usuário ",-1)])])])]),i("div",le,[i("div",re,[a[38]||(a[38]=i("div",{class:"stat-icon"},[i("i",{class:"fas fa-users"})],-1)),i("div",oe,[i("h3",null,d(f(t).users.length),1),a[37]||(a[37]=i("p",null,"Total de Usuários",-1))])]),i("div",ne,[a[40]||(a[40]=i("div",{class:"stat-icon active"},[i("i",{class:"fas fa-user-check"})],-1)),i("div",ie,[i("h3",null,d(f(t).activeUsers.length),1),a[39]||(a[39]=i("p",null,"Usuários Ativos",-1))])]),i("div",ue,[a[42]||(a[42]=i("div",{class:"stat-icon inactive"},[i("i",{class:"fas fa-user-times"})],-1)),i("div",de,[i("h3",null,d(f(t).inactiveUsers.length),1),a[41]||(a[41]=i("p",null,"Usuários Inativos",-1))])]),i("div",ce,[a[44]||(a[44]=i("div",{class:"stat-icon"},[i("i",{class:"fas fa-user-shield"})],-1)),i("div",me,[i("h3",null,d(f(t).roles.length),1),a[43]||(a[43]=i("p",null,"Perfis de Acesso",-1))])])]),i("div",ve,[i("div",pe,[i("div",fe,[a[46]||(a[46]=i("label",null,"Buscar usuário",-1)),i("div",he,[a[45]||(a[45]=i("i",{class:"fas fa-search"},null,-1)),h(i("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>L.value=e),placeholder:"Nome, email ou departamento..."},null,512),[[y,L.value]])])]),i("div",ye,[a[48]||(a[48]=i("label",null,"Perfil",-1)),h(i("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>R.value=e)},[a[47]||(a[47]=i("option",{value:""},"Todos os perfis",-1)),(o(!0),r(m,null,v(f(t).roles,e=>(o(),r("option",{key:e.id,value:e.id},d(e.name),9,ge))),128))],512),[[g,R.value]])]),i("div",be,[a[50]||(a[50]=i("label",null,"Departamento",-1)),h(i("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>$.value=e)},[a[49]||(a[49]=i("option",{value:""},"Todos os departamentos",-1)),(o(!0),r(m,null,v(f(t).departments,e=>(o(),r("option",{key:e,value:e},d(e),9,ke))),128))],512),[[g,$.value]])]),i("div",we,[a[52]||(a[52]=i("label",null,"Status",-1)),h(i("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>q.value=e)},[...a[51]||(a[51]=[i("option",{value:""},"Todos",-1),i("option",{value:"active"},"Ativo",-1),i("option",{value:"inactive"},"Inativo",-1)])],512),[[g,q.value]])])])]),i("div",Ce,[f(I)?(o(),b(B,{key:0,message:"Carregando usuários...",overlay:!0})):n("",!0),i("table",Ue,[a[56]||(a[56]=i("thead",null,[i("tr",null,[i("th",null,"Usuário"),i("th",null,"Email"),i("th",null,"Perfil"),i("th",null,"Departamento"),i("th",null,"Status"),i("th",null,"Último Login"),i("th",null,"Ações")])],-1)),i("tbody",null,[(o(!0),r(m,null,v(da.value,e=>(o(),r("tr",{key:e.id,class:"user-row"},[i("td",null,[i("div",Ae,[i("div",Ee,[e.avatar?(o(),r("img",{key:0,src:e.avatar,alt:e.name},null,8,Ie)):(o(),r("i",Ve))]),i("div",Se,[i("span",Fe,d(e.name),1),i("span",xe,"@"+d(e.username),1)])])]),i("td",null,d(e.email),1),i("td",null,[i("span",{class:"role-badge",style:k({backgroundColor:va(e.role)})},d(ma(e.role)),5)]),i("td",null,d(e.department),1),i("td",null,[i("span",{class:c(["status-badge",e.status])},d("active"===e.status?"Ativo":"Inativo"),3)]),i("td",null,[e.lastLogin?(o(),r("span",Be,d(fa(e.lastLogin)),1)):(o(),r("span",je,"Nunca logou"))]),i("td",null,[i("div",De,[i("button",{class:"btn-icon",onClick:a=>function(e){H.value=e,W.value={name:e.name,email:e.email,username:e.username,phone:e.phone||"",role:e.role,department:e.department,status:e.status,permissions:[...e.permissions]},ha()}(e),title:"Editar usuário"},[...a[53]||(a[53]=[i("i",{class:"fas fa-edit"},null,-1)])],8,Le),i("button",{class:"btn-icon",onClick:a=>function(e){try{t.toggleUserStatus(e)}catch(a){l(a,"Erro ao alterar status do usuário")}}(e.id),title:"active"===e.status?"Desativar usuário":"Ativar usuário"},[i("i",{class:c("active"===e.status?"fas fa-user-slash":"fas fa-user-check")},null,2)],8,Re),i("button",{class:"btn-icon warning",onClick:a=>function(e){J.value=e,K.value="",G.value=!0}(e),title:"Resetar senha do usuário"},[...a[54]||(a[54]=[i("i",{class:"fas fa-key"},null,-1)])],8,$e),i("button",{class:"btn-icon danger",onClick:a=>function(e){Z.value=e,_.value=!0}(e),title:"Excluir usuário"},[...a[55]||(a[55]=[i("i",{class:"fas fa-trash"},null,-1)])],8,Pe)])])]))),128))])])]),M.value?(o(),r("div",{key:0,class:"modal-overlay",onClick:ya},[i("div",{class:"modal",onClick:a[26]||(a[26]=w(()=>{},["stop"]))},[i("div",Te,[i("h2",null,d(H.value?"Editar Usuário":"Novo Usuário"),1),i("button",{class:"modal-close",onClick:ya},[...a[57]||(a[57]=[i("i",{class:"fas fa-times"},null,-1)])])]),i("div",ze,[i("form",{onSubmit:w(ga,["prevent"]),class:"user-form"},[i("div",Oe,[C(se,{label:"Nome Completo",type:"text",modelValue:W.value.name,"onUpdate:modelValue":a[4]||(a[4]=e=>W.value.name=e),error:f(ra)("name"),"is-valid":!f(oa)("name")&&f(Y).name,class:c(f(la)("name")),onBlur:a[5]||(a[5]=e=>f(na)("name")),onInput:a[6]||(a[6]=e=>f(ia)("name")),required:"",placeholder:"Digite o nome completo"},null,8,["modelValue","error","is-valid","class"]),C(se,{label:"Email",type:"email",modelValue:W.value.email,"onUpdate:modelValue":a[7]||(a[7]=e=>W.value.email=e),error:f(ra)("email"),"is-valid":!f(oa)("email")&&f(Y).email,class:c(f(la)("email")),onBlur:a[8]||(a[8]=e=>f(na)("email")),onInput:a[9]||(a[9]=e=>f(ia)("email")),required:"",placeholder:"usuario@empresa.com"},null,8,["modelValue","error","is-valid","class"]),C(se,{label:"Nome de Usuário",type:"text",modelValue:W.value.username,"onUpdate:modelValue":a[10]||(a[10]=e=>W.value.username=e),error:f(ra)("username"),"is-valid":!f(oa)("username")&&f(Y).username,class:c(f(la)("username")),onBlur:a[11]||(a[11]=e=>f(na)("username")),onInput:a[12]||(a[12]=e=>f(ia)("username")),required:"",placeholder:"usuario.nome"},null,8,["modelValue","error","is-valid","class"]),C(se,{label:"Telefone",type:"tel",modelValue:W.value.phone,"onUpdate:modelValue":a[13]||(a[13]=e=>W.value.phone=e),error:f(ra)("phone"),"is-valid":!f(oa)("phone")&&f(Y).phone,class:c(f(la)("phone")),onBlur:a[14]||(a[14]=e=>f(na)("phone")),onInput:a[15]||(a[15]=e=>f(ia)("phone")),placeholder:"(11) 99999-9999"},null,8,["modelValue","error","is-valid","class"]),C(se,{label:"Perfil",type:"select",modelValue:W.value.role,"onUpdate:modelValue":a[16]||(a[16]=e=>W.value.role=e),error:f(ra)("role"),"is-valid":!f(oa)("role")&&f(Y).role,class:c(f(la)("role")),onBlur:a[17]||(a[17]=e=>f(na)("role")),onChange:a[18]||(a[18]=e=>f(ia)("role")),required:"",placeholder:"Selecione um perfil",options:f(t).roles.map(e=>({value:e.id,label:e.name}))},null,8,["modelValue","error","is-valid","class","options"]),C(se,{label:"Departamento",type:"select",modelValue:W.value.department,"onUpdate:modelValue":a[19]||(a[19]=e=>W.value.department=e),error:f(ra)("department"),"is-valid":!f(oa)("department")&&f(Y).department,class:c(f(la)("department")),onBlur:a[20]||(a[20]=e=>f(na)("department")),onChange:a[21]||(a[21]=e=>f(ia)("department")),required:"",placeholder:"Selecione um departamento",options:f(t).departments.map(e=>({value:e,label:e}))},null,8,["modelValue","error","is-valid","class","options"]),C(se,{label:"Status",type:"select",modelValue:W.value.status,"onUpdate:modelValue":a[22]||(a[22]=e=>W.value.status=e),error:f(ra)("status"),"is-valid":!f(oa)("status")&&f(Y).status,class:c(f(la)("status")),onBlur:a[23]||(a[23]=e=>f(na)("status")),onChange:a[24]||(a[24]=e=>f(ia)("status")),placeholder:"Selecione o status",options:[{value:"active",label:"Ativo"},{value:"inactive",label:"Inativo"}]},null,8,["modelValue","error","is-valid","class"])]),i("div",Ne,[a[58]||(a[58]=i("h3",null,"Permissões Personalizadas",-1)),a[59]||(a[59]=i("p",{class:"permissions-note"}," As permissões abaixo são adicionais ao perfil selecionado ",-1)),i("div",qe,[(o(!0),r(m,null,v(ca.value,e=>(o(),r("div",{key:e,class:"permission-category"},[i("h4",null,d(e),1),i("div",Me,[(o(!0),r(m,null,v(pa(e),e=>(o(),r("label",{key:e.id,class:"permission-item"},[h(i("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":a[25]||(a[25]=e=>W.value.permissions=e)},null,8,_e),[[U,W.value.permissions]]),i("span",null,d(e.name),1)]))),128))])]))),128))])]),i("div",Ge,[i("button",{type:"button",class:"btn btn-outline",onClick:ya}," Cancelar "),i("button",{type:"submit",class:c(["btn btn-primary",{"btn-disabled":!f(ee)}]),disabled:!f(ee)},d(H.value?"Atualizar":"Criar")+" Usuário ",11,He)]),Object.keys(f(X)).length>0?(o(),r("div",Ze,[a[60]||(a[60]=i("h4",null,"Corrija os seguintes erros:",-1)),i("ul",null,[(o(!0),r(m,null,v(f(X),(e,a)=>(o(),r("li",{key:a},d(e),1))),128))])])):n("",!0)],32)])])])):n("",!0),_.value?(o(),r("div",{key:1,class:"modal-overlay",onClick:a[30]||(a[30]=e=>_.value=!1)},[i("div",{class:"modal small",onClick:a[29]||(a[29]=w(()=>{},["stop"]))},[i("div",Je,[a[62]||(a[62]=i("h2",null,"Confirmar Exclusão",-1)),i("button",{class:"modal-close",onClick:a[27]||(a[27]=e=>_.value=!1)},[...a[61]||(a[61]=[i("i",{class:"fas fa-times"},null,-1)])])]),i("div",Ke,[i("p",null,[a[63]||(a[63]=u("Tem certeza que deseja excluir o usuário ",-1)),i("strong",null,d(null==(s=Z.value)?void 0:s.name),1),a[64]||(a[64]=u("?",-1))]),a[65]||(a[65]=i("p",{class:"warning-text"},"Esta ação não pode ser desfeita.",-1)),i("div",We,[i("button",{class:"btn btn-outline",onClick:a[28]||(a[28]=e=>_.value=!1)}," Cancelar "),i("button",{class:"btn btn-danger",onClick:ba}," Excluir Usuário ")])])])])):n("",!0),G.value?(o(),r("div",{key:2,class:"modal-overlay",onClick:a[33]||(a[33]=e=>G.value=!1)},[i("div",{class:"modal small",onClick:a[32]||(a[32]=w(()=>{},["stop"]))},[i("div",Qe,[a[67]||(a[67]=i("h2",null,"Resetar Senha",-1)),i("button",{class:"modal-close",onClick:a[31]||(a[31]=e=>G.value=!1)},[...a[66]||(a[66]=[i("i",{class:"fas fa-times"},null,-1)])])]),i("div",Xe,[i("p",null,[a[68]||(a[68]=u("Tem certeza que deseja resetar a senha do usuário ",-1)),i("strong",null,d(null==(p=J.value)?void 0:p.name),1),a[69]||(a[69]=u("?",-1))]),a[73]||(a[73]=i("p",{class:"info-text"},"Uma nova senha temporária será gerada e exibida para você.",-1)),K.value?(o(),r("div",Ye,[a[71]||(a[71]=i("h4",null,"Nova Senha Temporária:",-1)),i("div",ea,[i("code",null,d(K.value),1),i("button",{class:"btn-icon",onClick:Ca,title:"Copiar senha"},[...a[70]||(a[70]=[i("i",{class:"fas fa-copy"},null,-1)])])]),a[72]||(a[72]=i("p",{class:"warning-text"},"⚠️ Anote esta senha! Ela não será exibida novamente.",-1))])):n("",!0),i("div",aa,[i("button",{class:"btn btn-outline",onClick:wa},d(K.value?"Fechar":"Cancelar"),1),K.value?n("",!0):(o(),r("button",{key:0,class:"btn btn-warning",onClick:ka}," Resetar Senha "))])])])])):n("",!0)])}}},[["__scopeId","data-v-1167ab58"]]);export{sa as default};
//# sourceMappingURL=Users-1aSGLU6i.js.map
