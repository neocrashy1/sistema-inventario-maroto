import{_ as e,l as a}from"./index-Dur0lEaU.js";import{e as t,f as l,x as o,D as s,B as n,m as r,K as i,an as d,a9 as u,ao as c,F as v,C as p,y as m,u as b,r as f,c as g,w as h,o as L,k as y}from"./vue-vendor-BY5hdAT7.js";import{u as D}from"./thirdPartyLoans-C751nSTY.js";import"./utils-vendor-COuxBHZ0.js";const w={class:"third-party-loans"},P={class:"page-header"},C={class:"header-content"},x={class:"header-actions"},E=["disabled"],R={class:"stats-grid"},k={class:"stat-card"},S={class:"stat-content"},N={class:"stat-number"},M={class:"stat-card"},T={class:"stat-content"},A={class:"stat-number"},V={class:"stat-card"},U={class:"stat-content"},F={class:"stat-number"},I={class:"stat-card"},q={class:"stat-content"},O={class:"stat-number"},B={class:"filters-section"},j={class:"filters-grid"},Q={class:"filter-group"},_={class:"filter-group"},G={class:"filter-group"},z={class:"filter-group"},J={class:"date-range"},K={class:"filter-actions"},H={class:"results-info"},W={class:"table-container"},X={class:"data-table"},Y=["value"],Z={class:"code"},$={class:"third-party-info"},ee={class:"name"},ae={class:"type"},te={class:"contact-info"},le={class:"contact-name"},oe={class:"contact-email"},se={class:"asset-info"},ne={class:"asset-name"},re={class:"asset-code"},ie={class:"action-buttons"},de=["onClick"],ue=["onClick"],ce=["onClick"],ve={class:"pagination-container"},pe={class:"pagination-info"},me={class:"pagination"},be=["disabled"],fe={class:"page-info"},ge=["disabled"],he={class:"modal-header"},Le={class:"modal-body"},ye={class:"form-grid"},De={class:"form-group"},we={class:"form-group"},Pe={class:"form-group"},Ce={class:"form-group"},xe={class:"form-group"},Ee={class:"form-group"},Re={class:"form-group"},ke=["value"],Se={class:"form-group"},Ne={class:"form-group"},Me={class:"form-group full-width"},Te={class:"form-group full-width"},Ae={class:"modal-actions"},Ve=["disabled"],Ue={class:"modal-header"},Fe={class:"modal-body"},Ie={class:"loan-summary"},qe={class:"form-group"},Oe={class:"form-group"},Be={class:"form-group"},je={class:"modal-actions"},Qe=["disabled"],_e={key:2,class:"alert alert-success"},Ge={key:3,class:"alert alert-error"};const ze=e({name:"ThirdPartyLoans",setup(){const e=D(),t=f(""),l=f(""),o=f(""),s=f(""),n=f(""),r=f(1),i=f(10),d=f([]),u=f(!1),c=f(!1),v=f(!1),p=f(null),m=f({thirdPartyType:"",thirdPartyName:"",thirdPartyDocument:"",contactName:"",contactEmail:"",contactPhone:"",assetId:"",loanDate:(new Date).toISOString().split("T")[0],expectedReturnDate:"",purpose:"",notes:""}),b=f({returnDate:(new Date).toISOString().split("T")[0],condition:"",returnNotes:""}),y=f(""),w=f(""),{loans:P,loading:C,error:x,totalLoans:E,activeLoans:R,overdueLoans:k,returnedLoans:S,availableAssetsForLoan:N}=e,M=g(()=>{let e=P;if(t.value){const a=t.value.toLowerCase();e=e.filter(e=>e.code.toLowerCase().includes(a)||e.thirdParty.name.toLowerCase().includes(a)||e.thirdParty.contactName.toLowerCase().includes(a)||e.thirdParty.contactEmail.toLowerCase().includes(a)||e.asset.name.toLowerCase().includes(a)||e.asset.code.toLowerCase().includes(a))}return l.value&&(e=e.filter(e=>e.status===l.value)),o.value&&(e=e.filter(e=>e.thirdParty.type===o.value)),(s.value||n.value)&&(e=e.filter(e=>{const a=new Date(e.loanDate),t=s.value?new Date(s.value):new Date("1900-01-01"),l=n.value?new Date(n.value):new Date("2100-12-31");return a>=t&&a<=l})),e}),T=g(()=>Math.ceil(M.value.length/i.value)),A=g(()=>(r.value-1)*i.value),V=g(()=>Math.min(A.value+i.value,M.value.length)),U=g(()=>M.value.slice(A.value,V.value)),F=()=>{c.value=!1,I()},I=()=>{m.value={thirdPartyType:"",thirdPartyName:"",thirdPartyDocument:"",contactName:"",contactEmail:"",contactPhone:"",assetId:"",loanDate:(new Date).toISOString().split("T")[0],expectedReturnDate:"",purpose:"",notes:""}},q=()=>{v.value=!1,p.value=null,b.value={returnDate:(new Date).toISOString().split("T")[0],condition:"",returnNotes:""}};return h([t,l,o,s,n],()=>{r.value=1}),h(x,a=>{a&&(w.value=a,setTimeout(()=>{e.clearError(),w.value=""},5e3))}),L(()=>{e.fetchLoans()}),{searchQuery:t,statusFilter:l,typeFilter:o,dateRangeStart:s,dateRangeEnd:n,currentPage:r,selectedLoans:d,selectAll:u,showNewLoanModal:c,showReturnModal:v,selectedLoan:p,newLoan:m,returnData:b,successMessage:y,errorMessage:w,loading:C,totalLoans:E,activeLoans:R,overdueLoans:k,returnedLoans:S,availableAssetsForLoan:N,filteredLoans:M,totalPages:T,startIndex:A,endIndex:V,paginatedLoans:U,formatDate:e=>e?new Date(e).toLocaleDateString("pt-BR"):"-",getStatusClass:e=>({Ativo:"status-active","Em Atraso":"status-overdue",Devolvido:"status-returned",Cancelado:"status-cancelled"}[e]||""),clearFilters:()=>{t.value="",l.value="",o.value="",s.value="",n.value="",r.value=1},toggleSelectAll:()=>{u.value?d.value=U.value.map(e=>e.id):d.value=[]},closeNewLoanModal:F,createLoan:async()=>{try{await e.createLoan(m.value),y.value="Empréstimo criado com sucesso!",F(),setTimeout(()=>{y.value=""},3e3)}catch(a){w.value=a.message,setTimeout(()=>{w.value=""},5e3)}},openReturnModal:e=>{p.value=e,b.value={returnDate:(new Date).toISOString().split("T")[0],condition:"",returnNotes:""},v.value=!0},closeReturnModal:q,processReturn:async()=>{try{await e.returnLoan(p.value.id,b.value),y.value="Devolução registrada com sucesso!",q(),setTimeout(()=>{y.value=""},3e3)}catch(a){w.value=a.message,setTimeout(()=>{w.value=""},5e3)}},editLoan:e=>{a.debug("Editar empréstimo:",e)},viewLoanDetails:e=>{a.debug("Ver detalhes do empréstimo:",e)},exportLoans:async()=>{try{await e.exportLoans("csv",{status:l.value,type:o.value,startDate:s.value,endDate:n.value}),y.value="Relatório exportado com sucesso!",setTimeout(()=>{y.value=""},3e3)}catch(a){w.value="Erro ao exportar relatório",setTimeout(()=>{w.value=""},5e3)}}}}},[["render",function(e,a,f,g,h,L){var D,ze,Je,Ke;return y(),t("div",w,[l("div",P,[l("div",C,[a[39]||(a[39]=l("div",{class:"header-text"},[l("h1",{class:"page-title"},"Empréstimos para Terceiros"),l("p",{class:"page-subtitle"},"Gerencie empréstimos de ativos para empresas e pessoas externas")],-1)),l("div",x,[l("button",{class:"btn btn-outline",onClick:a[0]||(a[0]=(...e)=>g.exportLoans&&g.exportLoans(...e)),disabled:g.loading},[...a[37]||(a[37]=[l("i",{class:"fas fa-download"},null,-1),s(" Exportar ",-1)])],8,E),l("button",{class:"btn btn-primary",onClick:a[1]||(a[1]=e=>g.showNewLoanModal=!0)},[...a[38]||(a[38]=[l("i",{class:"fas fa-plus"},null,-1),s(" Novo Empréstimo ",-1)])])])])]),l("div",R,[l("div",k,[a[41]||(a[41]=l("div",{class:"stat-icon"},[l("i",{class:"fas fa-handshake"})],-1)),l("div",S,[l("div",N,n(g.totalLoans),1),a[40]||(a[40]=l("div",{class:"stat-label"},"Total de Empréstimos",-1))])]),l("div",M,[a[43]||(a[43]=l("div",{class:"stat-icon active"},[l("i",{class:"fas fa-clock"})],-1)),l("div",T,[l("div",A,n(g.activeLoans.length),1),a[42]||(a[42]=l("div",{class:"stat-label"},"Ativos",-1))])]),l("div",V,[a[45]||(a[45]=l("div",{class:"stat-icon overdue"},[l("i",{class:"fas fa-exclamation-triangle"})],-1)),l("div",U,[l("div",F,n(g.overdueLoans.length),1),a[44]||(a[44]=l("div",{class:"stat-label"},"Em Atraso",-1))])]),l("div",I,[a[47]||(a[47]=l("div",{class:"stat-icon returned"},[l("i",{class:"fas fa-check-circle"})],-1)),l("div",q,[l("div",O,n(g.returnedLoans.length),1),a[46]||(a[46]=l("div",{class:"stat-label"},"Devolvidos",-1))])])]),l("div",B,[l("div",j,[l("div",Q,[a[48]||(a[48]=l("label",null,"Buscar",-1)),r(l("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>g.searchQuery=e),placeholder:"Empresa, contato, ativo, código...",class:"form-input"},null,512),[[i,g.searchQuery]])]),l("div",_,[a[50]||(a[50]=l("label",null,"Status",-1)),r(l("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>g.statusFilter=e),class:"form-select"},[...a[49]||(a[49]=[u('<option value="" data-v-15577bb5>Todos os Status</option><option value="Ativo" data-v-15577bb5>Ativo</option><option value="Em Atraso" data-v-15577bb5>Em Atraso</option><option value="Devolvido" data-v-15577bb5>Devolvido</option><option value="Cancelado" data-v-15577bb5>Cancelado</option>',5)])],512),[[d,g.statusFilter]])]),l("div",G,[a[52]||(a[52]=l("label",null,"Tipo de Terceiro",-1)),r(l("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>g.typeFilter=e),class:"form-select"},[...a[51]||(a[51]=[l("option",{value:""},"Todos os Tipos",-1),l("option",{value:"Empresa"},"Empresa",-1),l("option",{value:"Pessoa Física"},"Pessoa Física",-1),l("option",{value:"Prestador de Serviço"},"Prestador de Serviço",-1)])],512),[[d,g.typeFilter]])]),l("div",z,[a[54]||(a[54]=l("label",null,"Período",-1)),l("div",J,[r(l("input",{type:"date","onUpdate:modelValue":a[5]||(a[5]=e=>g.dateRangeStart=e),class:"form-input"},null,512),[[i,g.dateRangeStart]]),a[53]||(a[53]=l("span",null,"até",-1)),r(l("input",{type:"date","onUpdate:modelValue":a[6]||(a[6]=e=>g.dateRangeEnd=e),class:"form-input"},null,512),[[i,g.dateRangeEnd]])])]),l("div",K,[l("button",{class:"btn btn-outline btn-sm",onClick:a[7]||(a[7]=(...e)=>g.clearFilters&&g.clearFilters(...e))}," Limpar Filtros ")])])]),l("div",H,[l("span",null,n(g.filteredLoans.length)+" empréstimo(s) encontrado(s)",1)]),l("div",W,[l("table",X,[l("thead",null,[l("tr",null,[l("th",null,[r(l("input",{type:"checkbox","onUpdate:modelValue":a[8]||(a[8]=e=>g.selectAll=e),onChange:a[9]||(a[9]=(...e)=>g.toggleSelectAll&&g.toggleSelectAll(...e))},null,544),[[c,g.selectAll]])]),a[55]||(a[55]=l("th",null,"Código",-1)),a[56]||(a[56]=l("th",null,"Terceiro",-1)),a[57]||(a[57]=l("th",null,"Contato",-1)),a[58]||(a[58]=l("th",null,"Ativo",-1)),a[59]||(a[59]=l("th",null,"Data Empréstimo",-1)),a[60]||(a[60]=l("th",null,"Data Prevista",-1)),a[61]||(a[61]=l("th",null,"Status",-1)),a[62]||(a[62]=l("th",null,"Ações",-1))])]),l("tbody",null,[(y(!0),t(v,null,p(g.paginatedLoans,e=>(y(),t("tr",{key:e.id},[l("td",null,[r(l("input",{type:"checkbox","onUpdate:modelValue":a[10]||(a[10]=e=>g.selectedLoans=e),value:e.id},null,8,Y),[[c,g.selectedLoans]])]),l("td",null,[l("span",Z,n(e.code),1)]),l("td",null,[l("div",$,[l("div",ee,n(e.thirdParty.name),1),l("div",ae,n(e.thirdParty.type),1)])]),l("td",null,[l("div",te,[l("div",le,n(e.thirdParty.contactName),1),l("div",oe,n(e.thirdParty.contactEmail),1)])]),l("td",null,[l("div",se,[l("div",ne,n(e.asset.name),1),l("div",re,n(e.asset.code),1)])]),l("td",null,n(g.formatDate(e.loanDate)),1),l("td",null,n(g.formatDate(e.expectedReturnDate)),1),l("td",null,[l("span",{class:m(["status-badge",g.getStatusClass(e.status)])},n(e.status),3)]),l("td",null,[l("div",ie,["Ativo"===e.status||"Em Atraso"===e.status?(y(),t("button",{key:0,class:"btn btn-sm btn-success",onClick:a=>g.openReturnModal(e),title:"Registrar Devolução"},[...a[63]||(a[63]=[l("i",{class:"fas fa-undo"},null,-1)])],8,de)):o("",!0),l("button",{class:"btn btn-sm btn-outline",onClick:a=>g.editLoan(e),title:"Editar"},[...a[64]||(a[64]=[l("i",{class:"fas fa-edit"},null,-1)])],8,ue),l("button",{class:"btn btn-sm btn-info",onClick:a=>g.viewLoanDetails(e),title:"Ver Detalhes"},[...a[65]||(a[65]=[l("i",{class:"fas fa-eye"},null,-1)])],8,ce)])])]))),128))])])]),l("div",ve,[l("div",pe," Mostrando "+n(g.startIndex+1)+" a "+n(g.endIndex)+" de "+n(g.filteredLoans.length)+" registros ",1),l("div",me,[l("button",{class:"btn btn-sm btn-outline",onClick:a[11]||(a[11]=e=>g.currentPage--),disabled:1===g.currentPage}," Anterior ",8,be),l("span",fe,n(g.currentPage)+" de "+n(g.totalPages),1),l("button",{class:"btn btn-sm btn-outline",onClick:a[12]||(a[12]=e=>g.currentPage++),disabled:g.currentPage===g.totalPages}," Próxima ",8,ge)])]),g.showNewLoanModal?(y(),t("div",{key:0,class:"modal-overlay",onClick:a[28]||(a[28]=(...e)=>g.closeNewLoanModal&&g.closeNewLoanModal(...e))},[l("div",{class:"modal",onClick:a[27]||(a[27]=b(()=>{},["stop"]))},[l("div",he,[a[67]||(a[67]=l("h3",null,"Novo Empréstimo para Terceiro",-1)),l("button",{class:"modal-close",onClick:a[13]||(a[13]=(...e)=>g.closeNewLoanModal&&g.closeNewLoanModal(...e))},[...a[66]||(a[66]=[l("i",{class:"fas fa-times"},null,-1)])])]),l("div",Le,[l("form",{onSubmit:a[26]||(a[26]=b((...e)=>g.createLoan&&g.createLoan(...e),["prevent"]))},[l("div",ye,[l("div",De,[a[69]||(a[69]=l("label",null,"Tipo de Terceiro *",-1)),r(l("select",{"onUpdate:modelValue":a[14]||(a[14]=e=>g.newLoan.thirdPartyType=e),class:"form-select",required:""},[...a[68]||(a[68]=[l("option",{value:""},"Selecione o tipo",-1),l("option",{value:"Empresa"},"Empresa",-1),l("option",{value:"Pessoa Física"},"Pessoa Física",-1),l("option",{value:"Prestador de Serviço"},"Prestador de Serviço",-1)])],512),[[d,g.newLoan.thirdPartyType]])]),l("div",we,[a[70]||(a[70]=l("label",null,"Nome/Razão Social *",-1)),r(l("input",{type:"text","onUpdate:modelValue":a[15]||(a[15]=e=>g.newLoan.thirdPartyName=e),class:"form-input",required:"",placeholder:"Nome da empresa ou pessoa"},null,512),[[i,g.newLoan.thirdPartyName]])]),l("div",Pe,[a[71]||(a[71]=l("label",null,"CNPJ/CPF",-1)),r(l("input",{type:"text","onUpdate:modelValue":a[16]||(a[16]=e=>g.newLoan.thirdPartyDocument=e),class:"form-input",placeholder:"Documento de identificação"},null,512),[[i,g.newLoan.thirdPartyDocument]])]),l("div",Ce,[a[72]||(a[72]=l("label",null,"Nome do Contato *",-1)),r(l("input",{type:"text","onUpdate:modelValue":a[17]||(a[17]=e=>g.newLoan.contactName=e),class:"form-input",required:"",placeholder:"Pessoa responsável"},null,512),[[i,g.newLoan.contactName]])]),l("div",xe,[a[73]||(a[73]=l("label",null,"Email do Contato *",-1)),r(l("input",{type:"email","onUpdate:modelValue":a[18]||(a[18]=e=>g.newLoan.contactEmail=e),class:"form-input",required:"",placeholder:"email@exemplo.com"},null,512),[[i,g.newLoan.contactEmail]])]),l("div",Ee,[a[74]||(a[74]=l("label",null,"Telefone",-1)),r(l("input",{type:"tel","onUpdate:modelValue":a[19]||(a[19]=e=>g.newLoan.contactPhone=e),class:"form-input",placeholder:"(11) 99999-9999"},null,512),[[i,g.newLoan.contactPhone]])]),l("div",Re,[a[76]||(a[76]=l("label",null,"Ativo *",-1)),r(l("select",{"onUpdate:modelValue":a[20]||(a[20]=e=>g.newLoan.assetId=e),class:"form-select",required:""},[a[75]||(a[75]=l("option",{value:""},"Selecione o ativo",-1)),(y(!0),t(v,null,p(g.availableAssetsForLoan,e=>(y(),t("option",{key:e.id,value:e.id},n(e.name)+" ("+n(e.code)+") ",9,ke))),128))],512),[[d,g.newLoan.assetId]])]),l("div",Se,[a[77]||(a[77]=l("label",null,"Data do Empréstimo *",-1)),r(l("input",{type:"date","onUpdate:modelValue":a[21]||(a[21]=e=>g.newLoan.loanDate=e),class:"form-input",required:""},null,512),[[i,g.newLoan.loanDate]])]),l("div",Ne,[a[78]||(a[78]=l("label",null,"Data Prevista de Devolução *",-1)),r(l("input",{type:"date","onUpdate:modelValue":a[22]||(a[22]=e=>g.newLoan.expectedReturnDate=e),class:"form-input",required:""},null,512),[[i,g.newLoan.expectedReturnDate]])]),l("div",Me,[a[79]||(a[79]=l("label",null,"Finalidade do Empréstimo",-1)),r(l("textarea",{"onUpdate:modelValue":a[23]||(a[23]=e=>g.newLoan.purpose=e),class:"form-textarea",rows:"3",placeholder:"Descreva a finalidade do empréstimo..."},null,512),[[i,g.newLoan.purpose]])]),l("div",Te,[a[80]||(a[80]=l("label",null,"Observações",-1)),r(l("textarea",{"onUpdate:modelValue":a[24]||(a[24]=e=>g.newLoan.notes=e),class:"form-textarea",rows:"3",placeholder:"Observações adicionais..."},null,512),[[i,g.newLoan.notes]])])]),l("div",Ae,[l("button",{type:"button",class:"btn btn-outline",onClick:a[25]||(a[25]=(...e)=>g.closeNewLoanModal&&g.closeNewLoanModal(...e))}," Cancelar "),l("button",{type:"submit",class:"btn btn-primary",disabled:g.loading},n(g.loading?"Criando...":"Criar Empréstimo"),9,Ve)])],32)])])])):o("",!0),g.showReturnModal?(y(),t("div",{key:1,class:"modal-overlay",onClick:a[36]||(a[36]=(...e)=>g.closeReturnModal&&g.closeReturnModal(...e))},[l("div",{class:"modal",onClick:a[35]||(a[35]=b(()=>{},["stop"]))},[l("div",Ue,[a[82]||(a[82]=l("h3",null,"Registrar Devolução",-1)),l("button",{class:"modal-close",onClick:a[29]||(a[29]=(...e)=>g.closeReturnModal&&g.closeReturnModal(...e))},[...a[81]||(a[81]=[l("i",{class:"fas fa-times"},null,-1)])])]),l("div",Fe,[l("div",Ie,[l("h4",null,n(null==(D=g.selectedLoan)?void 0:D.thirdParty.name),1),l("p",null,n(null==(ze=g.selectedLoan)?void 0:ze.asset.name)+" ("+n(null==(Je=g.selectedLoan)?void 0:Je.asset.code)+")",1),l("p",null,"Emprestado em: "+n(g.formatDate(null==(Ke=g.selectedLoan)?void 0:Ke.loanDate)),1)]),l("form",{onSubmit:a[34]||(a[34]=b((...e)=>g.processReturn&&g.processReturn(...e),["prevent"]))},[l("div",qe,[a[83]||(a[83]=l("label",null,"Data de Devolução *",-1)),r(l("input",{type:"date","onUpdate:modelValue":a[30]||(a[30]=e=>g.returnData.returnDate=e),class:"form-input",required:""},null,512),[[i,g.returnData.returnDate]])]),l("div",Oe,[a[85]||(a[85]=l("label",null,"Condição do Ativo *",-1)),r(l("select",{"onUpdate:modelValue":a[31]||(a[31]=e=>g.returnData.condition=e),class:"form-select",required:""},[...a[84]||(a[84]=[u('<option value="" data-v-15577bb5>Selecione a condição</option><option value="Perfeito" data-v-15577bb5>Perfeito</option><option value="Bom" data-v-15577bb5>Bom</option><option value="Regular" data-v-15577bb5>Regular</option><option value="Danificado" data-v-15577bb5>Danificado</option>',5)])],512),[[d,g.returnData.condition]])]),l("div",Be,[a[86]||(a[86]=l("label",null,"Observações da Devolução",-1)),r(l("textarea",{"onUpdate:modelValue":a[32]||(a[32]=e=>g.returnData.returnNotes=e),class:"form-textarea",rows:"4",placeholder:"Descreva o estado do ativo e outras observações..."},null,512),[[i,g.returnData.returnNotes]])]),l("div",je,[l("button",{type:"button",class:"btn btn-outline",onClick:a[33]||(a[33]=(...e)=>g.closeReturnModal&&g.closeReturnModal(...e))}," Cancelar "),l("button",{type:"submit",class:"btn btn-success",disabled:g.loading},n(g.loading?"Processando...":"Registrar Devolução"),9,Qe)])],32)])])])):o("",!0),g.successMessage?(y(),t("div",_e,n(g.successMessage),1)):o("",!0),g.errorMessage?(y(),t("div",Ge,n(g.errorMessage),1)):o("",!0)])}],["__scopeId","data-v-15577bb5"]]);export{ze as default};
//# sourceMappingURL=ThirdPartyLoans-CJrqytMs.js.map
