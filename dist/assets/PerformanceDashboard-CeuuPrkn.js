import{r as e,c as t,o as r,a,n as s,w as n,e as i,k as c,f as o,x as l,D as d,y as m,z as u,B as v,L as p,F as h,C as g,m as y,an as f}from"./vue-vendor-BY5hdAT7.js";import{_ as w}from"./index-Dur0lEaU.js";import"./utils-vendor-COuxBHZ0.js";function b(n={}){const{enableFPSMonitoring:i=!0,enableMemoryMonitoring:c=!0,enableNetworkMonitoring:o=!0,enableRenderMonitoring:l=!0,sampleInterval:d=1e3,maxSamples:m=60,thresholds:u={fps:{warning:30,critical:15},memory:{warning:50,critical:80},renderTime:{warning:16,critical:33}}}=n,v=e(!1),p=e({fps:0,memory:{used:0,total:0,percentage:0},renderTime:0,networkLatency:0,domNodes:0,timestamp:Date.now()}),h=e([]),g=e([]),y=e(100);let f=0,w=0,b=null,k=null,M=0,T=null;const S=t(()=>{if(0===h.value.length)return p.value;const e=h.value.slice(-10),t={fps:0,memory:{used:0,total:0,percentage:0},renderTime:0,networkLatency:0,domNodes:0};e.forEach(e=>{t.fps+=e.fps,t.memory.used+=e.memory.used,t.memory.total+=e.memory.total,t.memory.percentage+=e.memory.percentage,t.renderTime+=e.renderTime,t.networkLatency+=e.networkLatency,t.domNodes+=e.domNodes});const r=e.length;return{fps:Math.round(t.fps/r*100)/100,memory:{used:Math.round(t.memory.used/r*100)/100,total:Math.round(t.memory.total/r*100)/100,percentage:Math.round(t.memory.percentage/r*100)/100},renderTime:Math.round(t.renderTime/r*100)/100,networkLatency:Math.round(t.networkLatency/r*100)/100,domNodes:Math.round(t.domNodes/r)}}),L=t(()=>{const e=y.value;return e>=80?{level:"excellent",color:"#22c55e",text:"Excelente"}:e>=60?{level:"good",color:"#3b82f6",text:"Bom"}:e>=40?{level:"fair",color:"#f59e0b",text:"Regular"}:e>=20?{level:"poor",color:"#ef4444",text:"Ruim"}:{level:"critical",color:"#dc2626",text:"CrÃ­tico"}}),x=t(()=>g.value.slice(-5)),D=()=>{if(!i)return 0;const e=performance.now();if(f++,0===w)return w=e,0;const t=e-w;if(t>=1e3){const r=Math.round(1e3*f/t);return f=0,w=e,r}return p.value.fps},$=()=>{if(!c||!performance.memory)return{used:0,total:0,percentage:0};const e=performance.memory,t=Math.round(e.usedJSHeapSize/1024/1024*100)/100,r=Math.round(e.totalJSHeapSize/1024/1024*100)/100;return{used:t,total:r,percentage:r>0?Math.round(t/r*1e4)/100:0}},N=()=>{if(!l)return 0;const e=performance.now();return M>0?Math.round(100*(e-M))/100:0},R=async()=>{if(!o)return 0;try{const e=performance.now();await fetch("/api/ping",{method:"HEAD",cache:"no-cache"});const t=performance.now();return Math.round(100*(t-e))/100}catch(e){return-1}},O=async()=>{const e={fps:D(),memory:$(),renderTime:N(),networkLatency:await R(),domNodes:document.querySelectorAll("*").length,timestamp:Date.now()};return p.value=e,h.value.push(e),h.value.length>m&&(h.value=h.value.slice(-m)),y.value=(e=>{let t=100;const{fps:r,memory:a,renderTime:s,networkLatency:n}=e;return r<u.fps.critical?t-=30:r<u.fps.warning&&(t-=15),a.percentage>u.memory.critical?t-=25:a.percentage>u.memory.warning&&(t-=10),s>u.renderTime.critical?t-=20:s>u.renderTime.warning&&(t-=10),n>1e3?t-=15:n>500&&(t-=5),Math.max(0,Math.min(100,t))})(e),(e=>{const t=[];e.fps<u.fps.critical?t.push({id:`fps-critical-${Date.now()}`,type:"fps",severity:"critical",message:`FPS crÃ­tico: ${e.fps} (< ${u.fps.critical})`,timestamp:(new Date).toISOString(),value:e.fps,threshold:u.fps.critical}):e.fps<u.fps.warning&&t.push({id:`fps-warning-${Date.now()}`,type:"fps",severity:"warning",message:`FPS baixo: ${e.fps} (< ${u.fps.warning})`,timestamp:(new Date).toISOString(),value:e.fps,threshold:u.fps.warning}),e.memory.percentage>u.memory.critical?t.push({id:`memory-critical-${Date.now()}`,type:"memory",severity:"critical",message:`Uso crÃ­tico de memÃ³ria: ${e.memory.percentage}% (> ${u.memory.critical}%)`,timestamp:(new Date).toISOString(),value:e.memory.percentage,threshold:u.memory.critical}):e.memory.percentage>u.memory.warning&&t.push({id:`memory-warning-${Date.now()}`,type:"memory",severity:"warning",message:`Uso alto de memÃ³ria: ${e.memory.percentage}% (> ${u.memory.warning}%)`,timestamp:(new Date).toISOString(),value:e.memory.percentage,threshold:u.memory.warning}),e.renderTime>u.renderTime.critical?t.push({id:`render-critical-${Date.now()}`,type:"render",severity:"critical",message:`Tempo de renderizaÃ§Ã£o crÃ­tico: ${e.renderTime}ms (> ${u.renderTime.critical}ms)`,timestamp:(new Date).toISOString(),value:e.renderTime,threshold:u.renderTime.critical}):e.renderTime>u.renderTime.warning&&t.push({id:`render-warning-${Date.now()}`,type:"render",severity:"warning",message:`Tempo de renderizaÃ§Ã£o alto: ${e.renderTime}ms (> ${u.renderTime.warning}ms)`,timestamp:(new Date).toISOString(),value:e.renderTime,threshold:u.renderTime.warning}),t.length>0&&(g.value.push(...t),g.value.length>50&&(g.value=g.value.slice(-50)))})(e),e},P=()=>{v.value||(v.value=!0,(()=>{if(!i)return;const e=()=>{D(),v.value&&(b=requestAnimationFrame(e))};b=requestAnimationFrame(e)})(),l&&(T=new MutationObserver(()=>{M=performance.now(),s(()=>{const e=N();e>0&&(p.value.renderTime=e)})}),T.observe(document.body,{childList:!0,subtree:!0,attributes:!0})),k=setInterval(O,d),O())},C=()=>{v.value=!1,b&&(cancelAnimationFrame(b),b=null),k&&(clearInterval(k),k=null),T&&(T.disconnect(),T=null)};return r(()=>{!1!==n.autoStart&&P()}),a(()=>{C()}),{isMonitoring:v,currentMetrics:p,averageMetrics:S,metricsHistory:h,alerts:g,recentAlerts:x,performanceScore:y,performanceStatus:L,startMonitoring:P,stopMonitoring:C,clearHistory:()=>{h.value=[],g.value=[]},exportMetrics:()=>({current:p.value,average:S.value,history:h.value,alerts:g.value,performanceScore:y.value,status:L.value,timestamp:(new Date).toISOString()}),getMetricsTrend:(e,t=10)=>{const r=h.value.slice(-t);if(r.length<2)return"stable";const a=r.map(t=>{if(e.includes(".")){const[r,a]=e.split(".");return t[r][a]}return t[e]}),s=a[0],n=(a[a.length-1]-s)/s*100;return Math.abs(n)<5?"stable":n>0?"increasing":"decreasing"},collectMetrics:O}}const k={class:"dashboard-header"},M={class:"header-left"},T={class:"status-text"},S={class:"header-right"},L={class:"controls"},x=["title"],D={key:0},$={key:1},N=["disabled"],R={class:"performance-score"},O={class:"score-value"},P={class:"score-details"},C={class:"score-breakdown"},I={class:"breakdown-item"},F={class:"breakdown-item"},H={class:"breakdown-item"},j={class:"breakdown-item"},A={class:"metrics-grid"},B={class:"metric-card"},E={class:"metric-header"},U={class:"trend-icon"},_={class:"metric-content"},z={class:"metric-subtitle"},q={class:"metric-chart"},J={class:"metric-card"},W={class:"metric-header"},K={class:"trend-icon"},V={class:"metric-content"},G={class:"metric-subtitle"},Q={class:"memory-bar"},X={class:"metric-card"},Y={class:"metric-header"},Z={class:"trend-icon"},ee={class:"metric-content"},te={class:"metric-subtitle"},re={class:"render-indicator"},ae={class:"render-bar"},se={class:"metric-card"},ne={class:"metric-header"},ie={class:"trend-icon"},ce={class:"metric-content"},oe={class:"metric-subtitle"},le={class:"network-status"},de={class:"status-dots"},me={class:"metric-card"},ue={class:"metric-header"},ve={class:"trend-icon"},pe={class:"metric-content"},he={class:"metric-value"},ge={class:"metric-subtitle"},ye={class:"metric-card alerts-card"},fe={class:"metric-header"},we={class:"metric-content"},be={key:0,class:"no-alerts"},ke={key:1,class:"alerts-list"},Me={class:"alert-icon"},Te={key:0},Se={key:1},Le={key:2},xe={class:"alert-content"},De={class:"alert-message"},$e={class:"alert-time"},Ne={key:0,class:"history-chart"},Re={class:"chart-header"},Oe={class:"chart-controls"},Pe={class:"chart-container"},Ce=w({__name:"PerformanceDashboard",props:{autoStart:{type:Boolean,default:!0},showHistoryChart:{type:Boolean,default:!0},thresholds:{type:Object,default:()=>({fps:{warning:30,critical:15},memory:{warning:50,critical:80},renderTime:{warning:16,critical:33}})}},emits:["alert","performance-change"],setup(t,{emit:a}){const w=t,Ce=a,{isMonitoring:Ie,currentMetrics:Fe,averageMetrics:He,metricsHistory:je,recentAlerts:Ae,performanceScore:Be,performanceStatus:Ee,startMonitoring:Ue,stopMonitoring:_e,clearHistory:ze,exportMetrics:qe,getMetricsTrend:Je}=b({...w.thresholds,autoStart:w.autoStart}),We=e(null),Ke=e(null),Ve=e("fps"),Ge=e(w.showHistoryChart),Qe=e=>e>=w.thresholds.fps.warning?"good":e>=w.thresholds.fps.critical?"warning":"critical",Xe=e=>e<=w.thresholds.memory.warning?"good":e<=w.thresholds.memory.critical?"warning":"critical",Ye=e=>e<=w.thresholds.renderTime.warning?"good":e<=w.thresholds.renderTime.critical?"warning":"critical",Ze=e=>-1===e?"error":e<=100?"good":e<=500?"warning":"critical",et=()=>Je("fps"),tt=()=>Je("memory.percentage"),rt=()=>Je("renderTime"),at=()=>Je("networkLatency"),st=()=>Je("domNodes"),nt=e=>{switch(e){case"increasing":return"ðŸ“ˆ";case"decreasing":return"ðŸ“‰";default:return"âž¡ï¸"}},it=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),ct=e=>e<=1e3?"Simples":e<=5e3?"Moderado":"Complexo",ot=()=>{Ie.value?_e():Ue()},lt=()=>{ze()},dt=()=>{const e=qe(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`performance-metrics-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(r)},mt=()=>{Ge.value=!Ge.value},ut=()=>{if(!We.value)return;const e=We.value,t=e.getContext("2d"),r=e.width,a=e.height;t.clearRect(0,0,r,a);const s=je.value.slice(-20).map(e=>e.fps);if(s.length<2)return;const n=r/(s.length-1);t.strokeStyle="good"===Qe(Fe.value.fps)?"#22c55e":"warning"===Qe(Fe.value.fps)?"#f59e0b":"#ef4444",t.lineWidth=2,t.beginPath(),s.forEach((e,r)=>{const s=r*n,i=a-(e-0)/60*a;0===r?t.moveTo(s,i):t.lineTo(s,i)}),t.stroke()},vt=()=>{if(!Ke.value||!Ge.value)return;const e=Ke.value,t=e.getContext("2d"),r=e.width,a=e.height;t.clearRect(0,0,r,a);const s=je.value.map(e=>{if(Ve.value.includes(".")){const[t,r]=Ve.value.split(".");return e[t][r]}return e[Ve.value]});if(s.length<2)return;const n=Math.max(...s),i=Math.min(...s),c=n-i||1,o=r/(s.length-1);t.strokeStyle="#e5e7eb",t.lineWidth=1;for(let l=0;l<=5;l++){const e=a/5*l;t.beginPath(),t.moveTo(0,e),t.lineTo(r,e),t.stroke()}t.strokeStyle="#3b82f6",t.lineWidth=2,t.beginPath(),s.forEach((e,r)=>{const s=r*o,n=a-(e-i)/c*a;0===r?t.moveTo(s,n):t.lineTo(s,n)}),t.stroke(),t.fillStyle="rgba(59, 130, 246, 0.1)",t.lineTo(r,a),t.lineTo(0,a),t.closePath(),t.fill()};return n(je,()=>{s(()=>{ut(),vt()})},{deep:!0}),n(Ve,()=>{s(()=>{vt()})}),n(Ae,e=>{if(e.length>0){const t=e[e.length-1];Ce("alert",t)}},{deep:!0}),n(Be,(e,t)=>{Math.abs(e-t)>=10&&Ce("performance-change",{score:e,status:Ee.value,change:e-t})}),r(()=>{s(()=>{ut(),vt()})}),(e,t)=>{return c(),i("div",{class:m(["performance-dashboard",{"is-monitoring":u(Ie)}])},[o("div",k,[o("div",M,[t[2]||(t[2]=o("h3",{class:"dashboard-title"},[o("span",{class:"title-icon"},"âš¡"),d(" Performance Monitor ")],-1)),o("div",{class:m(["status-indicator",u(Ee).level])},[t[1]||(t[1]=o("span",{class:"status-dot"},null,-1)),o("span",T,v(u(Ee).text),1)],2)]),o("div",S,[o("div",L,[o("button",{onClick:ot,class:m(["control-btn",{active:u(Ie)}]),title:u(Ie)?"Parar monitoramento":"Iniciar monitoramento"},[u(Ie)?(c(),i("span",D,"â¸ï¸")):(c(),i("span",$,"â–¶ï¸"))],10,x),o("button",{onClick:lt,class:"control-btn",title:"Limpar histÃ³rico",disabled:!u(Ie)}," ðŸ—‘ï¸ ",8,N),o("button",{onClick:dt,class:"control-btn",title:"Exportar dados"}," ðŸ“Š ")])])]),o("div",R,[o("div",{class:"score-circle",style:p({"--score":u(Be)})},[o("div",O,v(u(Be)),1),t[3]||(t[3]=o("div",{class:"score-label"},"Score",-1))],4),o("div",P,[o("div",C,[o("div",I,[t[4]||(t[4]=o("span",{class:"breakdown-label"},"FPS:",-1)),o("span",{class:m(["breakdown-value",Qe(u(Fe).fps)])},v(u(Fe).fps),3)]),o("div",F,[t[5]||(t[5]=o("span",{class:"breakdown-label"},"MemÃ³ria:",-1)),o("span",{class:m(["breakdown-value",Xe(u(Fe).memory.percentage)])},v(u(Fe).memory.percentage)+"% ",3)]),o("div",H,[t[6]||(t[6]=o("span",{class:"breakdown-label"},"Render:",-1)),o("span",{class:m(["breakdown-value",Ye(u(Fe).renderTime)])},v(u(Fe).renderTime)+"ms ",3)]),o("div",j,[t[7]||(t[7]=o("span",{class:"breakdown-label"},"Rede:",-1)),o("span",{class:m(["breakdown-value",Ze(u(Fe).networkLatency)])},v(u(Fe).networkLatency)+"ms ",3)])])])]),o("div",A,[o("div",B,[o("div",E,[t[8]||(t[8]=o("h4",{class:"metric-title"},"FPS",-1)),o("div",{class:m(["metric-trend",et()])},[o("span",U,v(nt(et())),1)],2)]),o("div",_,[o("div",{class:m(["metric-value",Qe(u(Fe).fps)])},v(u(Fe).fps),3),o("div",z," MÃ©dia: "+v(u(He).fps),1),o("div",q,[o("canvas",{ref_key:"fpsChart",ref:We,width:"200",height:"60"},null,512)])])]),o("div",J,[o("div",W,[t[9]||(t[9]=o("h4",{class:"metric-title"},"MemÃ³ria",-1)),o("div",{class:m(["metric-trend",tt()])},[o("span",K,v(nt(tt())),1)],2)]),o("div",V,[o("div",{class:m(["metric-value",Xe(u(Fe).memory.percentage)])},v(u(Fe).memory.used)+"MB ",3),o("div",G,v(u(Fe).memory.percentage)+"% de "+v(u(Fe).memory.total)+"MB ",1),o("div",Q,[o("div",{class:m(["memory-fill",Xe(u(Fe).memory.percentage)]),style:p({width:u(Fe).memory.percentage+"%"})},null,6)])])]),o("div",X,[o("div",Y,[t[10]||(t[10]=o("h4",{class:"metric-title"},"Render Time",-1)),o("div",{class:m(["metric-trend",rt()])},[o("span",Z,v(nt(rt())),1)],2)]),o("div",ee,[o("div",{class:m(["metric-value",Ye(u(Fe).renderTime)])},v(u(Fe).renderTime)+"ms ",3),o("div",te," MÃ©dia: "+v(u(He).renderTime)+"ms ",1),o("div",re,[o("div",ae,[o("div",{class:m(["render-fill",Ye(u(Fe).renderTime)]),style:p({width:Math.min(u(Fe).renderTime/50*100,100)+"%"})},null,6)]),t[11]||(t[11]=o("div",{class:"render-thresholds"},[o("span",{class:"threshold good"},"16ms"),o("span",{class:"threshold warning"},"33ms")],-1))])])]),o("div",se,[o("div",ne,[t[12]||(t[12]=o("h4",{class:"metric-title"},"LatÃªncia de Rede",-1)),o("div",{class:m(["metric-trend",at()])},[o("span",ie,v(nt(at())),1)],2)]),o("div",ce,[o("div",{class:m(["metric-value",Ze(u(Fe).networkLatency)])},v(-1===u(Fe).networkLatency?"Erro":u(Fe).networkLatency+"ms"),3),o("div",oe," MÃ©dia: "+v(u(He).networkLatency)+"ms ",1),o("div",le,[o("div",de,[(c(),i(h,null,g(5,e=>{return o("div",{key:e,class:m(["status-dot",(t=e,r=u(Fe).networkLatency,-1===r?"error":r<=[50,100,200,500,1e3][t-1]?"active":"inactive")])},null,2);var t,r}),64))])])])]),o("div",me,[o("div",ue,[t[13]||(t[13]=o("h4",{class:"metric-title"},"DOM Nodes",-1)),o("div",{class:m(["metric-trend",st()])},[o("span",ve,v(nt(st())),1)],2)]),o("div",pe,[o("div",he,v(it(u(Fe).domNodes)),1),o("div",ge," MÃ©dia: "+v(it(u(He).domNodes)),1),o("div",{class:m(["dom-complexity",(r=u(Fe).domNodes,r<=1e3?"good":r<=5e3?"warning":"critical")])},v(ct(u(Fe).domNodes)),3)])]),o("div",ye,[o("div",fe,[t[14]||(t[14]=o("h4",{class:"metric-title"},"Alertas Recentes",-1)),o("div",{class:m(["alerts-count",{"has-alerts":u(Ae).length>0}])},v(u(Ae).length),3)]),o("div",we,[0===u(Ae).length?(c(),i("div",be,[...t[15]||(t[15]=[o("span",{class:"no-alerts-icon"},"âœ…",-1),o("span",{class:"no-alerts-text"},"Nenhum alerta",-1)])])):(c(),i("div",ke,[(c(!0),i(h,null,g(u(Ae).slice(0,3),e=>{return c(),i("div",{key:e.id,class:m(["alert-item",e.severity])},[o("div",Me,["critical"===e.severity?(c(),i("span",Te,"ðŸ”´")):"warning"===e.severity?(c(),i("span",Se,"ðŸŸ¡")):(c(),i("span",Le,"ðŸ”µ"))]),o("div",xe,[o("div",De,v(e.message),1),o("div",$e,v((t=e.timestamp,new Date(t).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}))),1)])],2);var t}),128))]))])])]),Ge.value?(c(),i("div",Ne,[o("div",Re,[t[17]||(t[17]=o("h4",{class:"chart-title"},"HistÃ³rico de Performance",-1)),o("div",Oe,[y(o("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>Ve.value=e),class:"metric-selector"},[...t[16]||(t[16]=[o("option",{value:"fps"},"FPS",-1),o("option",{value:"memory.percentage"},"MemÃ³ria (%)",-1),o("option",{value:"renderTime"},"Render Time (ms)",-1),o("option",{value:"networkLatency"},"LatÃªncia (ms)",-1)])],512),[[f,Ve.value]]),o("button",{onClick:mt,class:"toggle-chart-btn"},v(Ge.value?"ðŸ“‰":"ðŸ“ˆ"),1)])]),o("div",Pe,[o("canvas",{ref_key:"historyChart",ref:Ke,width:"800",height:"200"},null,512)])])):l("",!0)],2);var r}}},[["__scopeId","data-v-88877775"]]);export{Ce as default};
//# sourceMappingURL=PerformanceDashboard-CeuuPrkn.js.map
