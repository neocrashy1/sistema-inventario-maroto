import{r as a,c as e,w as s,o as l,e as t,f as i,D as n,B as o,g as r,m as c,an as u,F as d,C as v,z as m,k as p}from"./vue-vendor-BY5hdAT7.js";import{_ as h,u as b,i as f,l as g,j as y}from"./index-Dur0lEaU.js";import{u as w}from"./machines-DNpDirAW.js";import k from"./SimpleLineChart-D4SuUDGx.js";import A from"./SimplePieChart-CppmaDYr.js";import x from"./SimpleBarChart-CKerFFeC.js";import"./utils-vendor-COuxBHZ0.js";const M={class:"analytics-page"},C={class:"kpi-section"},j={class:"kpi-grid"},D={class:"kpi-card"},E={class:"kpi-content"},F={class:"kpi-card"},T={class:"kpi-content"},z={class:"kpi-card"},V={class:"kpi-content"},B={class:"kpi-card"},O={class:"kpi-content"},P={class:"charts-section"},S={class:"charts-grid"},q={class:"chart-container full-width"},I={class:"chart-container full-width"},_={class:"chart-header",style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"16px"}},R=["value"],U={class:"chart-container"},J={class:"chart-container"},N={class:"chart-container"},L={class:"chart-container"},G={class:"chart-container"},H={class:"summary-section"},Q={class:"summary-grid"},W={class:"summary-card"},K={class:"summary-list"},X={class:"summary-label"},Y={class:"summary-value"},Z={class:"summary-card"},$={class:"summary-list"},aa={class:"summary-item alert"},ea={class:"summary-value"},sa={class:"summary-item warning"},la={class:"summary-value"},ta=h({__name:"Analytics",setup(h){const ta=b(),ia=f(),na=w(),oa=a(null),ra=a([]),ca=a(null),ua=a({timestamps:[],cpu:[]}),da=a(!1),va=a(null),ma=e(()=>{var a;return(null==(a=ua.value)?void 0:a.timestamps)||[]}),pa=e(()=>{var a;return[{label:"CPU (%)",data:(null==(a=ua.value)?void 0:a.cpu)||[],color:"#ef4444"}]}),ha=async()=>{da.value=!0;try{const a=await y.analytics.getOverview();oa.value=a.data}catch(a){va.value="Falha ao carregar overview"}finally{da.value=!1}},ba=async()=>{var a;try{const e=await y.analytics.getTopCpu({limit:5});ra.value=(null==(a=e.data)?void 0:a.machines)||e.data||[]}catch(e){}},fa=async a=>{if(a)try{const e=await y.analytics.getMachineTimeseries(a,{metric:"cpu",window:"1h",interval:"1m"});ua.value=e.data||{timestamps:[],cpu:[]}}catch(e){}};s(ca,a=>{fa(a)});const ga=e(()=>ta.totalAssets||0),ya=e(()=>ta.totalValue||0),wa=e(()=>{var a;return(null==(a=ta.maintenanceAssets)?void 0:a.length)||0}),ka=e(()=>{var a;const e=(null==(a=ta.activeAssets)?void 0:a.length)||0,s=ga.value;return s>0?Math.round(e/s*100):0}),Aa=e(()=>{var a;return(null==(a=ta.expiredWarranties)?void 0:a.length)||0}),xa=e(()=>{var a;return(null==(a=ta.assetsNearingMaintenance)?void 0:a.length)||0}),Ma=e(()=>[{label:"Ativos Totais",data:[120,135,142,158,165,172,180,185,192,198,205,210],color:"#3b82f6"},{label:"Ativos Ativos",data:[100,115,125,140,148,155,162,168,175,182,188,195],color:"#10b981"},{label:"Em Manutenção",data:[15,12,10,8,9,7,8,6,7,5,6,4],color:"#f59e0b"}]),Ca=e(()=>["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]),ja=e(()=>{const a=ta.assetsByStatus||{};return[{label:"Ativo",value:a.ativo||195,color:"#10b981"},{label:"Inativo",value:a.inativo||8,color:"#6b7280"},{label:"Manutenção",value:a.manutencao||4,color:"#f59e0b"},{label:"Descartado",value:a.descartado||3,color:"#ef4444"}].filter(a=>a.value>0)}),Da=e(()=>{const a=ta.assetsByCategory||{Computadores:45,"Móveis":38,Equipamentos:32,"Veículos":28,Ferramentas:25,Outros:22};return[{label:"Quantidade",data:Object.values(a),color:"#3b82f6"}]}),Ea=e(()=>{const a=ta.assetsByCategory||{Computadores:45,"Móveis":38,Equipamentos:32,"Veículos":28,Ferramentas:25,Outros:22};return Object.keys(a)}),Fa=e(()=>[{label:"Ativos",data:[42,38,35,28,25,22],color:"#8b5cf6"}]),Ta=e(()=>["TI","Administrativo","Produção","RH","Financeiro","Marketing"]),za=e(()=>[{label:"Computadores",value:45e4,color:"#3b82f6"},{label:"Veículos",value:38e4,color:"#10b981"},{label:"Equipamentos",value:32e4,color:"#f59e0b"},{label:"Móveis",value:18e4,color:"#8b5cf6"},{label:"Ferramentas",value:12e4,color:"#ef4444"},{label:"Outros",value:8e4,color:"#6b7280"}]),Va=e(()=>[{label:"Depreciação Acumulada",data:[5e4,95e3,135e3,17e4,2e5,225e3,245e3,26e4,27e4,275e3,28e4,285e3],color:"#ef4444"}]),Ba=e(()=>Ca.value),Oa=e(()=>[{name:"Computadores",count:45},{name:"Móveis",count:38},{name:"Equipamentos",count:32},{name:"Veículos",count:28},{name:"Ferramentas",count:25}]),Pa=async()=>{var a;try{da.value=!0,await Promise.all([ta.fetchAssets(),ia.fetchDashboardData(),na.fetchMachines(),ha(),ba()]),!ca.value&&(null==(a=na.machines)?void 0:a.length)&&(ca.value=na.machines[0].id),ca.value&&await fa(ca.value)}catch(e){g.error("Erro ao atualizar dados de analytics",e)}finally{da.value=!1}};return l(async()=>{await Pa()}),(a,e)=>{return p(),t("div",M,[i("div",{class:"page-header"},[i("div",{class:"header-content"},[e[3]||(e[3]=i("div",{class:"header-text"},[i("h1",null,"Analytics"),i("p",null,"Análise detalhada dos ativos e tendências")],-1)),i("div",{class:"header-actions"},[i("button",{class:"btn btn-outline",onClick:Pa},[...e[1]||(e[1]=[i("i",{class:"fas fa-sync-alt"},null,-1),n(" Atualizar ",-1)])]),e[2]||(e[2]=i("button",{class:"btn btn-primary"},[i("i",{class:"fas fa-download"}),n(" Exportar Relatório ")],-1))])])]),i("div",C,[i("div",j,[i("div",D,[e[6]||(e[6]=i("div",{class:"kpi-icon"},[i("i",{class:"fas fa-chart-line text-blue-500"})],-1)),i("div",E,[i("h3",null,o(ga.value),1),e[4]||(e[4]=i("p",null,"Total de Ativos",-1)),e[5]||(e[5]=i("span",{class:"kpi-trend positive"},[i("i",{class:"fas fa-arrow-up"}),n(" +12% este mês ")],-1))])]),i("div",F,[e[9]||(e[9]=i("div",{class:"kpi-icon"},[i("i",{class:"fas fa-dollar-sign text-green-500"})],-1)),i("div",T,[i("h3",null,o((s=ya.value,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s))),1),e[7]||(e[7]=i("p",null,"Valor Total",-1)),e[8]||(e[8]=i("span",{class:"kpi-trend positive"},[i("i",{class:"fas fa-arrow-up"}),n(" +8% este mês ")],-1))])]),i("div",z,[e[12]||(e[12]=i("div",{class:"kpi-icon"},[i("i",{class:"fas fa-tools text-orange-500"})],-1)),i("div",V,[i("h3",null,o(wa.value),1),e[10]||(e[10]=i("p",null,"Em Manutenção",-1)),e[11]||(e[11]=i("span",{class:"kpi-trend negative"},[i("i",{class:"fas fa-arrow-down"}),n(" -5% este mês ")],-1))])]),i("div",B,[e[15]||(e[15]=i("div",{class:"kpi-icon"},[i("i",{class:"fas fa-percentage text-purple-500"})],-1)),i("div",O,[i("h3",null,o(ka.value)+"%",1),e[13]||(e[13]=i("p",null,"Taxa de Utilização",-1)),e[14]||(e[14]=i("span",{class:"kpi-trend positive"},[i("i",{class:"fas fa-arrow-up"}),n(" +3% este mês ")],-1))])])])]),i("div",P,[i("div",S,[i("div",q,[r(k,{title:"Tendências Mensais de Ativos",datasets:Ma.value,labels:Ca.value,width:800,height:300,"show-legend":!0,"show-grid":!0},null,8,["datasets","labels"])]),i("div",I,[i("div",_,[e[16]||(e[16]=i("h3",null,"Performance da Máquina",-1)),c(i("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>ca.value=a),class:"select"},[(p(!0),t(d,null,v(m(na).machines,a=>(p(),t("option",{key:a.id,value:a.id},o(a.name||a.hostname||a.id),9,R))),128))],512),[[u,ca.value]])]),r(k,{title:"CPU ao longo do tempo",datasets:pa.value,labels:ma.value,width:800,height:300,"show-legend":!0,"show-grid":!0},null,8,["datasets","labels"])]),i("div",U,[r(A,{title:"Distribuição por Status",data:ja.value,size:300,donut:!0,"show-center-text":!0,"show-legend":!0},null,8,["data"])]),i("div",J,[r(x,{title:"Ativos por Categoria",datasets:Da.value,labels:Ea.value,width:400,height:300,"show-legend":!0,"show-grid":!0},null,8,["datasets","labels"])]),i("div",N,[r(x,{title:"Ativos por Departamento",datasets:Fa.value,labels:Ta.value,width:400,height:300,"show-legend":!0,"show-grid":!0,horizontal:""},null,8,["datasets","labels"])]),i("div",L,[r(A,{title:"Valor por Categoria",data:za.value,size:300,donut:!1,"show-legend":!0},null,8,["data"])]),i("div",G,[r(k,{title:"Depreciação Acumulada",datasets:Va.value,labels:Ba.value,width:400,height:300,"show-legend":!0,"show-grid":!0},null,8,["datasets","labels"])])])]),i("div",H,[i("div",Q,[i("div",W,[e[17]||(e[17]=i("h3",null,"Top 5 Categorias",-1)),i("div",K,[(p(!0),t(d,null,v(Oa.value,(a,e)=>(p(),t("div",{key:e,class:"summary-item"},[i("span",X,o(a.name),1),i("span",Y,o(a.count)+" ativos",1)]))),128))])]),i("div",Z,[e[22]||(e[22]=i("h3",null,"Alertas Importantes",-1)),i("div",$,[i("div",aa,[e[18]||(e[18]=i("i",{class:"fas fa-exclamation-triangle text-red-500"},null,-1)),e[19]||(e[19]=i("span",{class:"summary-label"},"Garantias Expiradas",-1)),i("span",ea,o(Aa.value),1)]),i("div",sa,[e[20]||(e[20]=i("i",{class:"fas fa-clock text-orange-500"},null,-1)),e[21]||(e[21]=i("span",{class:"summary-label"},"Manutenção Próxima",-1)),i("span",la,o(xa.value),1)])])])])])]);var s}}},[["__scopeId","data-v-10dcecd9"]]);export{ta as default};
//# sourceMappingURL=Analytics-5b7lyxAt.js.map
