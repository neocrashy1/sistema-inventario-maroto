// ===================================
// RESPONSIVE DESIGN SYSTEM
// ===================================

// Import Sass modules
@use 'sass:map';
@use 'sass:math';

// Breakpoints
$breakpoints: (
  xs: 0,
  sm: 576px,
  md: 768px,
  lg: 992px,
  xl: 1200px,
  xxl: 1400px
);

// Media query mixins
@mixin media-up($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    $value: map.get($breakpoints, $breakpoint);
    @if $value != 0 {
      @media (min-width: $value) {
        @content;
      }
    } @else {
      @content;
    }
  }
}

@mixin media-down($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    $value: map.get($breakpoints, $breakpoint);
    @if $value != 0 {
      @media (max-width: $value - 1px) {
        @content;
      }
    }
  }
}

@mixin media-between($lower, $upper) {
  @if map.has-key($breakpoints, $lower) and map.has-key($breakpoints, $upper) {
    $lower-value: map.get($breakpoints, $lower);
    $upper-value: map.get($breakpoints, $upper);
    
    @if $lower-value != 0 {
      @media (min-width: $lower-value) and (max-width: $upper-value - 1px) {
        @content;
      }
    } @else {
      @media (max-width: $upper-value - 1px) {
        @content;
      }
    }
  }
}

// ===================================
// LAYOUT RESPONSIVO
// ===================================

// Container responsivo
.container {
  width: 100%;
  padding-left: var(--spacing-md);
  padding-right: var(--spacing-md);
  margin-left: auto;
  margin-right: auto;

  @include media-up(sm) {
    max-width: 540px;
  }

  @include media-up(md) {
    max-width: 720px;
  }

  @include media-up(lg) {
    max-width: 960px;
  }

  @include media-up(xl) {
    max-width: 1140px;
  }

  @include media-up(xxl) {
    max-width: 1320px;
  }
}

// Grid system responsivo
.row {
  display: flex;
  flex-wrap: wrap;
  margin-left: calc(var(--spacing-md) * -0.5);
  margin-right: calc(var(--spacing-md) * -0.5);
}

.col {
  flex: 1 0 0%;
  padding-left: calc(var(--spacing-md) * 0.5);
  padding-right: calc(var(--spacing-md) * 0.5);
}

// Colunas responsivas
@for $i from 1 through 12 {
  .col-#{$i} {
    flex: 0 0 auto;
    width: math.percentage(math.div($i, 12));
    padding-left: calc(var(--spacing-md) * 0.5);
    padding-right: calc(var(--spacing-md) * 0.5);
  }
}

@each $breakpoint in map.keys($breakpoints) {
  @include media-up($breakpoint) {
    @for $i from 1 through 12 {
      .col-#{$breakpoint}-#{$i} {
        flex: 0 0 auto;
        width: math.percentage(math.div($i, 12));
      }
    }
  }
}

// ===================================
// COMPONENTES RESPONSIVOS
// ===================================

// Header responsivo
.header {
  @include media-down(md) {
    .search-box {
      display: none !important;
    }
    
    .user-info {
      display: none !important;
    }
    
    .header-actions {
      gap: var(--spacing-sm);
    }
    
    .notification-btn {
      width: 36px;
      height: 36px;
    }
  }
  
  @include media-down(sm) {
    padding: var(--spacing-sm) var(--spacing-md);
    
    .logo span {
      display: none;
    }
    
    .header-actions {
      gap: var(--spacing-xs);
    }
  }
}

// Sidebar responsivo
.sidebar {
  @include media-down(lg) {
    position: fixed;
    left: -280px;
    z-index: 1050;
    transition: left 0.3s ease;
    
    &.mobile-open {
      left: 0;
    }
  }
  
  @include media-down(md) {
    width: 100vw;
    left: -100vw;
    
    &.mobile-open {
      left: 0;
    }
  }
}

// Main content responsivo
.main-content {
  @include media-down(lg) {
    margin-left: 0 !important;
  }
}

// Page content responsivo
.page-content {
  @include media-down(md) {
    padding: var(--spacing-md);
  }
  
  @include media-down(sm) {
    padding: var(--spacing-sm);
  }
}

// Dashboard responsivo
.dashboard {
  .page-header {
    @include media-down(md) {
      flex-direction: column;
      gap: var(--spacing-md);
      text-align: center;
    }
  }
  
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing-lg);
    
    @include media-down(md) {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
    }
    
    @include media-down(sm) {
      grid-template-columns: 1fr;
      gap: var(--spacing-sm);
    }
  }
  
  .charts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: var(--spacing-lg);
    
    @include media-down(lg) {
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    }
    
    @include media-down(md) {
      grid-template-columns: 1fr;
      gap: var(--spacing-md);
    }
  }
}

// Cards responsivos
.card {
  @include media-down(sm) {
    border-radius: var(--radius-md);
    
    .card-header,
    .card-body,
    .card-footer {
      padding: var(--spacing-md);
    }
  }
}

// Tabelas responsivas
.table-responsive {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  
  @include media-down(md) {
    .table {
      min-width: 600px;
      
      th,
      td {
        padding: var(--spacing-sm);
        font-size: 0.8rem;
      }
    }
  }
}

// Formulários responsivos
.form-row {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-md);
  
  @include media-down(md) {
    flex-direction: column;
    gap: var(--spacing-sm);
  }
  
  .form-group {
    flex: 1;
    min-width: 0;
    
    @include media-down(md) {
      flex: none;
    }
  }
}

// Botões responsivos
.btn-group {
  display: flex;
  gap: var(--spacing-sm);
  
  @include media-down(sm) {
    flex-direction: column;
    
    .btn {
      width: 100%;
      justify-content: center;
    }
  }
}

// ===================================
// UTILITIES RESPONSIVAS
// ===================================

// Display utilities
@each $breakpoint in map.keys($breakpoints) {
  @include media-up($breakpoint) {
    .d-#{$breakpoint}-none { display: none !important; }
    .d-#{$breakpoint}-block { display: block !important; }
    .d-#{$breakpoint}-flex { display: flex !important; }
    .d-#{$breakpoint}-grid { display: grid !important; }
  }
}

// Text alignment
@each $breakpoint in map.keys($breakpoints) {
  @include media-up($breakpoint) {
    .text-#{$breakpoint}-left { text-align: left !important; }
    .text-#{$breakpoint}-center { text-align: center !important; }
    .text-#{$breakpoint}-right { text-align: right !important; }
  }
}

// Spacing utilities
@each $breakpoint in map.keys($breakpoints) {
  @include media-up($breakpoint) {
    .p-#{$breakpoint}-0 { padding: 0 !important; }
    .p-#{$breakpoint}-1 { padding: var(--spacing-xs) !important; }
    .p-#{$breakpoint}-2 { padding: var(--spacing-sm) !important; }
    .p-#{$breakpoint}-3 { padding: var(--spacing-md) !important; }
    .p-#{$breakpoint}-4 { padding: var(--spacing-lg) !important; }
    .p-#{$breakpoint}-5 { padding: var(--spacing-xl) !important; }
    
    .m-#{$breakpoint}-0 { margin: 0 !important; }
    .m-#{$breakpoint}-1 { margin: var(--spacing-xs) !important; }
    .m-#{$breakpoint}-2 { margin: var(--spacing-sm) !important; }
    .m-#{$breakpoint}-3 { margin: var(--spacing-md) !important; }
    .m-#{$breakpoint}-4 { margin: var(--spacing-lg) !important; }
    .m-#{$breakpoint}-5 { margin: var(--spacing-xl) !important; }
  }
}

// ===================================
// MOBILE OVERLAY
// ===================================

.mobile-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1040;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  
  &.active {
    opacity: 1;
    visibility: visible;
  }
  
  @include media-up(lg) {
    display: none !important;
  }
}

// ===================================
// MOBILE MENU TOGGLE
// ===================================

.mobile-menu-toggle {
  display: none;
  
  @include media-down(lg) {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border: none;
    background: none;
    cursor: pointer;
    color: var(--text-primary);
    
    i {
      font-size: 1.25rem;
    }
  }
}

// ===================================
// PRINT STYLES
// ===================================

@media print {
  .sidebar,
  .header,
  .mobile-menu-toggle,
  .btn,
  .page-actions {
    display: none !important;
  }
  
  .main-content {
    margin-left: 0 !important;
  }
  
  .page-content {
    padding: 0 !important;
  }
  
  .card {
    border: 1px solid #000 !important;
    box-shadow: none !important;
  }
}