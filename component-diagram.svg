<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="650" viewBox="0 0 1100 650">
  <defs>
    <style type="text/css"><![CDATA[
      .box { fill: #ffffff; stroke: #1f2937; stroke-width: 2; rx: 12; }
      .title { font: 700 16px sans-serif; fill: #111827; }
      .text { font: 400 13px sans-serif; fill: #374151; }
      .note { font: 400 12px sans-serif; fill: #6b7280; }
      .arrow { stroke: #111827; stroke-width: 2; marker-end: url(#arrowhead); }
      .lock { font: 700 14px sans-serif; fill: #065f46; }
      .badge { fill: #e5e7eb; stroke: #9ca3af; stroke-width: 1; rx: 8; }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#111827" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="550" y="40" text-anchor="middle" class="title">Arquitetura Cliente-Servidor (Agente Python → API REST → Banco → Dashboard React)</text>

  <!-- Python Agent -->
  <rect x="60" y="120" width="260" height="140" class="box"/>
  <text x="190" y="145" text-anchor="middle" class="title">Agente Python (Edge)</text>
  <text x="80" y="170" class="text">• Coleta métricas de máquinas</text>
  <text x="80" y="190" class="text">• Envia alertas e status (HTTP/JSON)</text>
  <text x="80" y="210" class="text">• Autenticação com JWT Bearer</text>
  <text x="80" y="230" class="note">Bibliotecas: requests, asyncio, websockets</text>

  <!-- REST API -->
  <rect x="420" y="100" width="300" height="180" class="box"/>
  <text x="570" y="125" text-anchor="middle" class="title">API REST (FastAPI)</text>
  <text x="440" y="150" class="text">• Endpoints:</text>
  <text x="450" y="170" class="text">/machines/register, /machines/status</text>
  <text x="450" y="190" class="text">/tickets/create, /alerts/send</text>
  <text x="450" y="210" class="text">/dashboard/alerts, /dashboard/stats</text>
  <rect x="430" y="220" width="140" height="40" class="badge"/>
  <text x="500" y="245" text-anchor="middle" class="lock">TLS + JWT (Bearer)</text>

  <!-- Token/Auth Service (within API) -->
  <rect x="740" y="100" width="260" height="140" class="box"/>
  <text x="870" y="125" text-anchor="middle" class="title">Auth Service (JWT)</text>
  <text x="760" y="150" class="text">• /auth/login, /auth/refresh, /auth/me</text>
  <text x="760" y="170" class="text">• Roles: admin, operator, viewer</text>
  <text x="760" y="190" class="note">Tokens curtos + Refresh tokens</text>

  <!-- Database -->
  <rect x="420" y="330" width="300" height="180" class="box"/>
  <text x="570" y="355" text-anchor="middle" class="title">Banco de Dados</text>
  <text x="440" y="380" class="text">• PostgreSQL (preferível) ou SQL Server</text>
  <text x="440" y="400" class="text">• Tabelas: machines, alerts, tickets, users</text>
  <text x="440" y="420" class="text">• Índices por status/severity/machine_id</text>
  <text x="440" y="440" class="note">ORM: SQLAlchemy + Alembic (migrations)</text>

  <!-- Dashboard React -->
  <rect x="800" y="320" width="240" height="180" class="box"/>
  <text x="920" y="345" text-anchor="middle" class="title">Dashboard (React)</text>
  <text x="820" y="370" class="text">• KPIs, gráficos, alertas em tempo real</text>
  <text x="820" y="390" class="text">• Consome API via HTTPS + Bearer</text>
  <text x="820" y="410" class="note">Vite, Axios/Fetch, Zustand/Redux</text>

  <!-- Arrows & Security Notes -->
  <line x1="320" y1="190" x2="420" y2="190" class="arrow"/>
  <text x="370" y="170" text-anchor="middle" class="note">HTTPS</text>

  <line x1="570" y1="280" x2="570" y2="330" class="arrow"/>
  <text x="590" y="305" class="note">SQL</text>

  <line x1="720" y1="180" x2="740" y2="170" class="arrow"/>
  <text x="730" y="155" class="note">JWT</text>

  <line x1="720" y1="380" x2="720" y2="280" class="arrow"/>
  <text x="700" y="330" class="note">REST</text>

  <line x1="720" y1="380" x2="800" y2="380" class="arrow"/>
  <text x="760" y="360" text-anchor="middle" class="note">HTTPS</text>

  <!-- Edge → WebSocket (optional) -->
  <line x1="190" y1="260" x2="570" y2="330" class="arrow"/>
  <text x="360" y="300" class="note">WebSocket/Telemetry (opcional)</text>

  <!-- Footer Notes -->
  <text x="550" y="610" text-anchor="middle" class="note">Observações: TLS obrigatório, autenticação por token (JWT Bearer), logs centralizados, rate limiting e CORS configurados.</text>
</svg>